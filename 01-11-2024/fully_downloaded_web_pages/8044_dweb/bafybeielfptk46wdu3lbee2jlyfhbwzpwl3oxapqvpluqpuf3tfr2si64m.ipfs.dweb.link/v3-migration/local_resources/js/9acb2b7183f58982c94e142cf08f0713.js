(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4562],{40342:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return nt}});var n=r(59499),i=r(49501),s=r(30120),a=r(5152),o=r(11163),l=r(67294),c=r(45745),d=r(15446),u=r(25563),x=r(15070),h=r(75331),v=r(80854),p=r(1279),m=r(59148),b=r(27484),j=r.n(b),g=r(42568),f=r.n(g),y=r(83601),w=r(78371),Z=r(67728),C=r(25957),k=r(63263),S=r(52369),A=r(37197),I=r(45104),O=f()((function(e,t,r){return{reserves:e.reservesData,reservesIncentives:r,baseCurrencyData:e.baseCurrencyData,userEmodeCategoryId:t.userEmodeCategoryId,userReserves:t.userReserves}})),D=function(e){var t=(0,S.J)(e),r=(0,I.T)(e),n=(0,A.O)(e);return(0,C.W)([t,r,n],O)},B=r(49258);function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var T,R=f()((function(e,t,r,n,i,s,a){var o,l=e.borrowReserves,c=(null===t||void 0===t||null===(o=t.userReserves)||void 0===o?void 0:o.map((function(e){var t=e.scaledATokenBalance,r=e.principalStableDebt,n=e.scaledVariableDebt;return(0,Z.Wx)(i,e.underlyingAsset)>=0&&(t="0"),s.filter((function(t){return t.underlyingAsset==e.underlyingAsset})).filter((function(e){var t=l.find((function(t){return t.underlyingAsset==e.underlyingAsset}));return!!t&&void 0===t.migrationDisabled})).forEach((function(e){e.interestRate==h.tk.Stable?r="0":n="0"})),P(P({},e),{},{principalStableDebt:r,scaledATokenBalance:t,scaledVariableDebt:n})})))||[],d=(0,y.To)(t),u=(0,Z.qt)(null===t||void 0===t?void 0:t.reserves,null===t||void 0===t?void 0:t.reserveIncentives,c,d,j()().unix(),null===t||void 0===t?void 0:t.userEmodeCategoryId),x=(0,Z.B9)(i,e.supplyReserves,e.isolatedReserveV3),b=(0,Z.hA)(s,n,e),g=x.reduce((function(e,t){return e[t.underlyingAsset]=t,e}),{}),f=b.reduce((function(e,t){return e[t.debtKey]=t,e}),{}),w=n.userReservesData.map((function(e){var t=f[e.reserve.stableDebtTokenAddress],r=f[e.reserve.variableDebtTokenAddress],n=(0,Z.oO)(a,e),i=g[n],s=e.scaledVariableDebt,o=e.scaledATokenBalance,l=e.usageAsCollateralEnabledOnUser,c=(0,p.hE)(e.reserve.variableBorrowIndex);if(r&&void 0===r.migrationDisabled){var d=(0,m.e9)((0,v.gU)(r.increasedVariableBorrows,e.reserve.decimals),c);s=(0,p.hE)(s).plus(d).toString()}if(t&&void 0===t.migrationDisabled){var u=(0,m.e9)((0,v.gU)(t.increasedStableBorrows,e.reserve.decimals),c);s=(0,p.hE)(s).plus(u).toString()}if(i){var x;l=i.usageAsCollateralEnabledOnUserV3;var h=(0,p.hE)(e.scaledATokenBalance),b=(0,p.hE)(e.reserve.liquidityIndex),j=(null===(x=a[n])||void 0===x?void 0:x.amount)||(0,v.gU)(i.underlyingBalance,e.reserve.decimals),y=(0,m.e9)(j,b);o=h.plus(y).toString()}return P(P({},e),{},{id:e.reserve.id,scaledVariableDebt:s,scaledATokenBalance:o,usageAsCollateralEnabledOnUser:l})})),C=(0,y.To)(r),k=(0,Z.qt)(null===r||void 0===r?void 0:r.reserves,null===r||void 0===r?void 0:r.reserveIncentives,w,C,j()().unix(),null===r||void 0===r?void 0:r.userEmodeCategoryId);return{fromUserSummaryAfterMigration:u,toUserSummaryAfterMigration:{healthFactor:k.healthFactor,currentLoanToValue:k.currentLoanToValue,totalCollateralMarketReferenceCurrency:k.totalCollateralMarketReferenceCurrency,totalBorrowsMarketReferenceCurrency:k.totalBorrowsMarketReferenceCurrency}}})),E=r(55774),_=r(70675),F=r(77537),U=r(26079),V=r(33772),N=r(81481),L=r(62097),z=r(61225),W=r(70918),Y=r(22841),q=r(75158),H=r(29630),J=r(75084),G=r(81645),K=r(92391),X=r(69331),Q=r(18384),$=r(8195),ee=r(80227),te=r(78678),re=r(65445),ne=r(60082),ie=r(44731),se=r(80562),ae=r(73812),oe=r(31538),le=r(44373),ce=r(91655),de=r(96875),ue=r(63206),xe=r(85893),he=function(e){var t,r=e.marketData,n=e.userSummaryAfterMigration,i=e.userSummaryBeforeMigration,a=e.selectableMarkets,o=e.setFromMarketData,c=e.loading,d=(0,l.useState)(null),u=d[0],x=d[1],h=Boolean(u),v=(0,ue.Mo)(r.chainId);return(0,xe.jsxs)(s.Z,{sx:{padding:"12px 16px 16px 16px",border:1,borderColor:"divider",borderRadius:3,width:"100%"},children:[(0,xe.jsx)(H.Z,{variant:"subheader2",color:"text.primary",sx:{mb:2},children:"From"}),(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",mb:6},children:[(0,xe.jsx)(ne.Z,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:(0,xe.jsx)(ie.Z,{src:v.networkLogoPath,sx:{width:20,height:20}}),children:(0,xe.jsx)(ie.Z,{src:"/aave.svg",sx:{width:36,height:36}})}),(0,xe.jsx)(H.Z,{variant:"subheader1",sx:{ml:5},children:(t=r,"Aave ".concat(t.v3?"V3":"V2"," - ").concat(t.marketTitle).concat(t.isFork?" Fork":""))}),a&&o&&(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)(se.Z,{onClick:function(e){x(e.currentTarget)},sx:{ml:"auto"},children:h?(0,xe.jsx)(te.Z,{}):(0,xe.jsx)(re.Z,{})}),(0,xe.jsx)(ae.Z,{open:h,onClose:function(){x(null)},anchorEl:u,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:a.map((function(e){return(0,xe.jsxs)(s.Z,{children:[(0,xe.jsx)(s.Z,{sx:{py:2,px:4},children:(0,xe.jsx)(H.Z,{color:"text.secondary",variant:"subheader2",children:e.title})}),e.markets.map((function(e){var t=(0,ue.Mo)(e.chainId);return(0,xe.jsxs)(oe.Z,{onClick:function(){return function(e){o&&o(e),x(null)}(e)},children:[(0,xe.jsx)(ne.Z,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:(0,xe.jsx)(ie.Z,{src:t.networkLogoPath,sx:{width:16,height:16}}),children:(0,xe.jsx)(ie.Z,{src:"/aave.svg",sx:{width:24,height:24}})}),(0,xe.jsx)(H.Z,{variant:"secondary14",sx:{ml:3},children:"".concat(e.marketTitle).concat(e.isFork?" Fork":"")})]},"".concat(e.marketTitle,"_").concat(e.isFork))}))]},e.title)}))})]})]}),(0,xe.jsx)(le.Z,{}),(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mt:3},children:[(0,xe.jsx)(H.Z,{children:"Health Factor"}),(0,xe.jsx)(s.Z,{sx:{textAlign:"right"},children:(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[!c&&i?(0,xe.jsx)(de.o,{value:i.healthFactor}):(0,xe.jsx)(ce.Z,{width:50}),(0,xe.jsx)(G.Z,{sx:{fontSize:"16px",color:"text.primary",mx:1},children:(0,xe.jsx)(ee.Z,{})}),!c&&n?(0,xe.jsx)(de.o,{value:n.healthFactor}):(0,xe.jsx)(ce.Z,{width:50})]})})]})]})};!function(e){e[e.NO_SELECTION=0]="NO_SELECTION",e[e.V2_HF_TOO_LOW=1]="V2_HF_TOO_LOW",e[e.V3_HF_TOO_LOW=2]="V3_HF_TOO_LOW",e[e.INSUFFICIENT_LTV=3]="INSUFFICIENT_LTV"}(T||(T={}));var ve=function(e){switch(e.blockingError){case T.NO_SELECTION:return(0,xe.jsx)(i.cC,{id:"No assets selected to migrate."});case T.V2_HF_TOO_LOW:return(0,xe.jsx)(i.cC,{id:"This action will reduce V2 health factor below liquidation threshold. retain collateral or migrate borrow position to continue."});case T.V3_HF_TOO_LOW:return(0,xe.jsx)(xe.Fragment,{children:(0,xe.jsx)(i.cC,{id:"This action will reduce health factor of V3 below liquidation threshold. Increase migrated collateral or reduce migrated borrow to continue."})});case T.INSUFFICIENT_LTV:return(0,xe.jsx)(i.cC,{id:"The loan to value of the migrated positions would cause liquidation. Increase migrated collateral or reduce migrated borrow to continue."});default:return(0,xe.jsx)(xe.Fragment,{})}},pe=function(e){var t=e.disableButton,r=e.enteringIsolationMode,n=e.fromMarketData,a=e.toMarketData,o=e.userSummaryAfterMigration,c=e.userSummaryBeforeMigration,d=e.setFromMarketData,u=e.selectableMarkets,x=e.loading,h=(0,$.vR)().openV3Migration,v=(0,l.useState)(!1),m=v[0],b=v[1],j=(0,L.Z)(),g=(0,z.Z)(j.breakpoints.down("sm")),f=o?function(e,t,r){var n=e.toUserSummaryAfterMigration,i=n.totalCollateralMarketReferenceCurrency,s=n.totalBorrowsMarketReferenceCurrency,a=n.currentLoanToValue,o=(0,p.hE)(i).multipliedBy(a),l=(0,p.hE)(s).isGreaterThan(o);return t&&r?T.NO_SELECTION:Number(e.fromUserSummaryAfterMigration.healthFactor)<1.005&&"-1"!==e.fromUserSummaryAfterMigration.healthFactor?T.V2_HF_TOO_LOW:Number(e.toUserSummaryAfterMigration.healthFactor)<1.005&&"-1"!==e.toUserSummaryAfterMigration.healthFactor?T.V3_HF_TOO_LOW:l?T.INSUFFICIENT_LTV:null}(o,!!t,m):null;return(0,xe.jsx)(s.Z,{sx:{display:"flex",flexDirection:"column",width:{xs:"100%",lg:"40%"}},children:(0,xe.jsxs)(W.Z,{sx:{p:{xs:"16px 24px 24px 24px"},mb:{xs:6,md:0}},children:[(0,xe.jsx)(K.X,{caption:(0,xe.jsx)(i.cC,{id:"Migrate your assets"}),captionVariant:"h3",sx:{mb:6}}),(0,xe.jsxs)(s.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",gap:2,mb:12,position:"relative",alignItems:"center"},children:[(0,xe.jsx)(he,{marketData:n,userSummaryBeforeMigration:null===c||void 0===c?void 0:c.fromUserSummaryBeforeMigration,userSummaryAfterMigration:null===o||void 0===o?void 0:o.fromUserSummaryAfterMigration,selectableMarkets:u,setFromMarketData:d,loading:x}),(0,xe.jsx)(s.Z,{border:1,borderColor:"divider",bgcolor:"background.paper",sx:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",borderRadius:"12px",width:36,height:36},children:(0,xe.jsx)(N.Z,{})}),(0,xe.jsx)(he,{marketData:a,userSummaryBeforeMigration:null===c||void 0===c?void 0:c.toUserSummaryBeforeMigration,userSummaryAfterMigration:null===o||void 0===o?void 0:o.toUserSummaryAfterMigration,loading:x})]}),null!==f&&(0,xe.jsx)(X.v,{severity:"warning",children:(0,xe.jsx)(ve,{blockingError:f})}),r&&(0,xe.jsx)(Q.i,{severity:"warning"}),null===f&&(0,xe.jsx)(s.Z,{sx:{height:"44px",backgroundColor:"background.surface",borderRadius:"4px",display:"flex",justifyContent:"center",mb:4},"data-cy":"migration-risk-checkbox",children:(0,xe.jsx)(Y.Z,{sx:{margin:0},control:(0,xe.jsx)(q.Z,{checked:m,onChange:function(){return b(!m)},size:"small"}),label:(0,xe.jsx)(H.Z,{variant:"description",sx:{position:"relative",top:1},children:(0,xe.jsx)(i.cC,{id:"I fully understand the risks of migrating."})})})}),(0,xe.jsx)(s.Z,{children:(0,xe.jsx)(J.Z,{onClick:h,disabled:x||!m||null!==f,sx:{width:"100%",height:"44px"},variant:m&&null===f?"gradient":"contained",size:"medium","data-cy":"migration-button",children:(0,xe.jsx)(i.cC,{id:"Preview tx and migrate"})})}),(0,xe.jsxs)(s.Z,{sx:{p:g?"20px 16px":"20px 30px",mt:g?4:0},children:[(0,xe.jsxs)(H.Z,{variant:"h3",sx:{fontWeight:700,mb:{xs:4,lg:6},display:"flex",alignItems:"center"},children:[(0,xe.jsx)(G.Z,{sx:{fontSize:"24px",color:"warning.main",mr:2},children:(0,xe.jsx)(V.Z,{})}),(0,xe.jsx)(i.cC,{id:"Migration risks"})]}),(0,xe.jsx)(H.Z,{sx:{mb:{xs:3,lg:4}},children:(0,xe.jsx)(i.cC,{id:"Please always be aware of your <0>Health Factor (HF)</0> when partially migrating a position and that your rates will be updated to V3 rates.",components:{0:(0,xe.jsx)("b",{})}})}),(0,xe.jsx)(H.Z,{sx:{mb:{xs:3,lg:4}},children:(0,xe.jsx)(i.cC,{id:"Migrating multiple collaterals and borrowed assets at the same time can be an expensive operation and might fail in certain situations.<0>Therefore it\u2019s not recommended to migrate positions with more than 5 assets (deposited + borrowed) at the same time.</0>",components:{0:(0,xe.jsx)("b",{})}})}),(0,xe.jsx)(H.Z,{sx:{mb:{xs:4,lg:6}},children:(0,xe.jsx)(i.cC,{id:"Be mindful of the network congestion and gas prices."})})]})]})})},me=r(13902),be=r(58057),je=r(21386),ge=r(52906),fe=r(58771),ye=r(68861),we=r(58527),Ze=function(e){var t,r=e.dashboardLink,s=e.marketName,a=e.warningType,o=e.isolatedV3,l=(t={},(0,n.Z)(t,Z.b_.EModeBorrowDisabled,(0,xe.jsx)(i.cC,{id:"Asset cannot be migrated to {marketName} V3 Market due to E-mode restrictions. You can disable or manage E-mode categories in your <0>V3 Dashboard</0>",values:{marketName:s},components:{0:(0,xe.jsx)(ye.rU,{href:r||"",target:"_blank",underline:"always"})}})),(0,n.Z)(t,Z.b_.AssetNotFlashloanable,(0,xe.jsx)(i.cC,{id:"Flashloan is disabled for this asset, hence this position cannot be migrated."})),(0,n.Z)(t,Z.b_.InsufficientLiquidity,(0,xe.jsx)(i.cC,{id:"Asset cannot be migrated due to insufficient liquidity or borrow cap limitation in {marketName} v3 market.",values:{marketName:s}})),(0,n.Z)(t,Z.b_.NotEnoughtSupplies,(0,xe.jsx)(i.cC,{id:"Asset cannot be migrated due to supply cap restriction in {marketName} v3 market.",values:{marketName:s}})),(0,n.Z)(t,Z.b_.ReserveFrozen,(0,xe.jsx)(i.cC,{id:"Asset is frozen in {marketName} v3 market, hence this position cannot be migrated.",values:{marketName:s}})),(0,n.Z)(t,Z.b_.IsolationModeBorrowDisabled,o?(0,xe.jsx)(i.cC,{id:"Asset cannot be migrated because you have isolated collateral in {marketName} v3 Market which limits borrowable assets. You can manage your collateral in <0>{marketName} V3 Dashboard</0>",values:{marketName:s},components:{0:(0,xe.jsx)(ye.rU,{href:r||"",target:"_blank",underline:"always"})}}):(0,xe.jsx)(i.cC,{id:"Asset cannot be migrated to {marketName} v3 Market since collateral asset will enable isolation mode.",values:{marketName:s}})),(0,n.Z)(t,Z.b_.V3AssetMissing,(0,xe.jsx)(i.cC,{id:"Underlying asset does not exist in {marketName} v3 Market, hence this position cannot be migrated.",values:{marketName:s}})),t);return(0,xe.jsx)(we.G,{iconSize:16,color:"error.main",icon:(0,xe.jsx)(fe.Z,{}),children:(0,xe.jsx)(H.Z,{variant:"caption",color:"text.secondary",children:l[a]})})},Ce=r(44749),ke=r(45884),Se=r(32383),Ae=r(41024),Ie=r(14463),Oe=r(72667),De=r(54181),Be=function(e){var t=e.enableAsCollateral,r=e.enabledAsCollateral;return(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[(0,xe.jsx)(De.Z,{onClick:t,disableRipple:!0,checked:r,sx:{mb:-1.5}}),(0,xe.jsx)(Ce.Ch,{})]})},Me=function(e){var t=e.v2Amount,r=e.v2Price,n=e.v3Price,s=(0,l.useMemo)((function(){return function(e,t,r){if(!r)return{v3Amount:void 0,v3TotalPrice:void 0};var n=(0,p.hE)(t).div(r).multipliedBy(e),i=n.multipliedBy(r);return{v3Amount:n.toString(),v3TotalPrice:i.toString()}}(t,r,n)}),[t,r,n]),a=s.v3Amount,o=s.v3TotalPrice;return(0,xe.jsx)(X.v,{icon:!1,sx:{mb:4},severity:"error",children:(0,xe.jsxs)(H.Z,{variant:"caption",component:"span",children:[(0,xe.jsx)(i.cC,{id:"stETH tokens will be migrated to Wrapped stETH using Lido Protocol wrapper which leads to supply balance change after migration: {0}",values:{0:a?(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)(Ae.B,{variant:"caption",value:a})," (",(0,xe.jsx)(Ae.B,{variant:"caption",value:o,symbol:"USD",symbolsColor:"error.100"}),")."]}):(0,xe.jsx)(Ie.J,{variant:"caption",component:"span"})}})," "]})})},Pe=function(e){var t=e.checked,r=e.amount,n=e.amountInUSD,a=e.onCheckboxClick,o=e.enabledAsCollateral,l=e.disabled,c=e.enableAsCollateral,d=e.isIsolated,u=e.enteringIsolation,x=e.borrowApyType,v=e.userReserve,p=e.v3Rates,m=e.showCollateralToggle,b=e.isSupplyList,j=x?x===h.tk.Stable?v.stableBorrowAPY:v.reserve.variableBorrowAPY:v.reserve.supplyAPY,g=x?x===h.tk.Stable?v.reserve.sIncentivesData:v.reserve.vIncentivesData:v.reserve.aIncentivesData,f=x?(null===p||void 0===p?void 0:p.variableBorrowAPY)||"-1":(null===p||void 0===p?void 0:p.supplyAPY)||"-1",y=x?(null===p||void 0===p?void 0:p.vIncentivesData)||[]:(null===p||void 0===p?void 0:p.aIncentivesData)||[],Z=(0,w.Y)(),C=Z.currentMarket,k=Z.currentMarketData,S=(0,L.Z)(),A=void 0===l?"text.secondary":"text.muted",I=void 0===l?"text.primary":"text.muted",O=void 0===(null===p||void 0===p?void 0:p.ltv)&&void 0===(null===p||void 0===p?void 0:p.liquidationThreshold);return(0,xe.jsxs)(Se.H,{sx:{display:"flex",flexDirection:"column",pl:0},children:[(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",width:"100%",pb:2,pt:2.5},children:[(0,xe.jsx)(ke.h,{align:"center",maxWidth:48,minWidth:48,children:(0,xe.jsx)(s.Z,{sx:function(e){return{border:"2px solid ".concat(void 0!==l?e.palette.action.disabled:e.palette.text.secondary),background:void 0!==l?e.palette.background.disabled:t?e.palette.text.secondary:e.palette.background.paper,width:16,height:16,borderRadius:"2px","&:hover":{cursor:void 0!==l?"not-allowed":"pointer"},display:"flex",alignItems:"center",justifyContent:"center"}},onClick:void 0!==l?void 0:a,children:void 0===l&&(0,xe.jsx)(G.Z,{sx:{fontSize:"14px",color:"background.paper"},children:(0,xe.jsx)(be.Z,{})})})}),(0,xe.jsx)(ke.h,{align:"left",children:(0,xe.jsxs)(K.X,{children:[(0,xe.jsx)(Oe.T1,{symbol:v.reserve.iconSymbol,fontSize:"large"}),(0,xe.jsxs)(s.Z,{sx:{pl:"12px",overflow:"hidden",display:"flex"},children:[(0,xe.jsx)(H.Z,{variant:"subheader1",color:I,noWrap:!0,sx:{pr:1},children:v.reserve.symbol}),void 0!==l&&(0,xe.jsx)(Ze,{dashboardLink:ye.Z6.dashboard+"/?marketName="+C+"_v3",marketName:k.marketTitle,warningType:l,isolatedV3:u})]})]})})]}),(0,xe.jsxs)(s.Z,{sx:{width:"100%",display:"flex",flexDirection:"column",gap:2,pb:4,pl:12},children:[(0,xe.jsxs)(s.Z,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,xe.jsx)(H.Z,{variant:"description",color:A,children:(0,xe.jsx)(i.cC,{id:"Current v2 Balance"})}),(0,xe.jsxs)(s.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[(0,xe.jsx)(s.Z,{sx:{display:"flex",alignItems:"flex-end",mb:.5},children:(0,xe.jsx)(Ae.B,{value:r,variant:"secondary14",color:I})}),(0,xe.jsx)(Ae.B,{value:n,variant:"secondary12",color:A,symbolsColor:A,symbol:"USD"})]})]}),(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,xe.jsx)(H.Z,{variant:"description",color:A,children:(0,xe.jsx)(i.cC,{id:"APY change"})}),(0,xe.jsxs)(s.Z,{sx:{display:"flex"},children:[(0,xe.jsx)(ge.J,{value:j,symbol:v.reserve.symbol,incentives:g,variant:"main14",color:I}),(0,xe.jsx)(G.Z,{sx:{px:1.5},children:(0,xe.jsx)(ee.Z,{fontSize:"14px",color:void 0===l?S.palette.text.secondary:S.palette.text.muted})}),(0,xe.jsx)(ge.J,{value:f,symbol:v.reserve.symbol,incentives:y,variant:"main14",color:I})]})]}),!!c&&(0,xe.jsxs)(s.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,xe.jsx)(H.Z,{variant:"description",color:A,children:(0,xe.jsx)(i.cC,{id:"Collateral change"})}),(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center"},children:[v.usageAsCollateralEnabledOnUser&&"0"!==v.reserve.reserveLiquidationThreshold?(0,xe.jsx)(je.Z,{fontSize:"small",color:"success"}):(0,xe.jsx)(Ie.J,{variant:"main14",color:A}),(0,xe.jsx)(G.Z,{sx:{px:1.5},children:(0,xe.jsx)(ee.Z,{fontSize:"14px",color:void 0===l?S.palette.text.secondary:S.palette.text.muted})}),m?(0,xe.jsx)(Be,{enableAsCollateral:c,enabledAsCollateral:o}):o?d?(0,xe.jsxs)(s.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,xe.jsx)(G.Z,{sx:{color:"warning.main",fontSize:"20px"},children:(0,xe.jsx)(me.Z,{})}),(0,xe.jsx)(Ce.Ch,{})]}):(0,xe.jsx)(je.Z,{fontSize:"small",color:"success"}):(0,xe.jsx)(Ie.J,{variant:"main14",color:A})]})]}),!!x&&(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,xe.jsx)(H.Z,{variant:"description",color:A,children:(0,xe.jsx)(i.cC,{id:"APY type change"})}),(0,xe.jsxs)(s.Z,{sx:{display:"flex"},children:[(0,xe.jsx)(J.Z,{variant:"outlined",size:"small",sx:{width:"50px",background:"white"},disabled:!0,children:(0,xe.jsx)(H.Z,{variant:"buttonS",color:I,children:x})}),(0,xe.jsx)(G.Z,{sx:{px:1.5},children:(0,xe.jsx)(ee.Z,{fontSize:"14px",color:void 0===l?S.palette.text.secondary:S.palette.text.muted})}),(0,xe.jsx)(J.Z,{variant:"outlined",size:"small",sx:{width:"50px",background:"white"},disabled:!0,children:(0,xe.jsx)(H.Z,{variant:"buttonS",color:I,children:"Variable"})})]})]}),b&&(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,xe.jsx)(H.Z,{variant:"description",color:A,children:(0,xe.jsx)(i.cC,{id:"Max LTV"})}),(0,xe.jsx)(s.Z,{sx:{display:"flex"},children:O?(0,xe.jsx)(Ie.J,{variant:"main14",color:"text.secondary"}):(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)(Ae.B,{value:v.reserve.formattedBaseLTVasCollateral,percent:!0,variant:"main14",color:I}),(0,xe.jsx)(G.Z,{sx:{px:1.5},children:(0,xe.jsx)(ee.Z,{fontSize:"14px",color:void 0===l?S.palette.text.secondary:S.palette.text.muted})}),(0,xe.jsx)(Ae.B,{value:(null===p||void 0===p?void 0:p.ltv)||0,percent:!0,variant:"main14",color:I})]})})]}),!b&&(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,xe.jsx)(H.Z,{variant:"description",color:A,children:(0,xe.jsx)(i.cC,{id:"Liquidation threshold"})}),(0,xe.jsx)(s.Z,{sx:{display:"flex"},children:O?(0,xe.jsx)(Ie.J,{variant:"main14",color:"text.secondary"}):(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)(Ae.B,{value:v.reserve.formattedReserveLiquidationThreshold,percent:!0,variant:"main14",color:I}),(0,xe.jsx)(G.Z,{sx:{px:1.5},children:(0,xe.jsx)(ee.Z,{fontSize:"14px",color:void 0===l?S.palette.text.secondary:S.palette.text.muted})}),(0,xe.jsx)(Ae.B,{value:(null===p||void 0===p?void 0:p.liquidationThreshold)||0,percent:!0,variant:"main14",color:I})]})})]})]}),"stETH"===v.reserve.symbol&&(0,xe.jsx)(s.Z,{sx:{pl:"16px",width:"100%"},children:(0,xe.jsx)(Me,{v2Price:v.reserve.priceInUSD,v2Amount:r,v3Price:null===p||void 0===p?void 0:p.priceInUSD})})]})},Te=function(e){var t,r=e.checked,n=e.amount,i=e.amountInUSD,a=e.onCheckboxClick,o=e.enabledAsCollateral,l=e.disabled,c=e.enableAsCollateral,d=e.isIsolated,u=e.enteringIsolation,x=e.borrowApyType,v=e.userReserve,p=e.v3Rates,m=e.userControlledCollateral,b=e.canBeEnforced,j=e.isSupplyList,g=(0,L.Z)(),f=(0,w.Y)(),y=f.currentMarket,Z=f.currentMarketData,C=(0,z.Z)(g.breakpoints.down(1125)),k=void 0===l?"text.primary":"text.muted",S=void 0===l?"text.secondary":"text.muted",A=void 0===(null===p||void 0===p?void 0:p.ltv)&&void 0===(null===p||void 0===p?void 0:p.liquidationThreshold),I=x?x===h.tk.Stable?v.stableBorrowAPY:v.reserve.variableBorrowAPY:v.reserve.supplyAPY,O=x?x===h.tk.Stable?v.reserve.sIncentivesData:v.reserve.vIncentivesData:v.reserve.aIncentivesData,D=x?(null===p||void 0===p?void 0:p.variableBorrowAPY)||"-1":(null===p||void 0===p?void 0:p.supplyAPY)||"-1",B=x?(null===p||void 0===p?void 0:p.vIncentivesData)||[]:(null===p||void 0===p?void 0:p.aIncentivesData)||[],M=m&&d&&b;return C?(0,xe.jsx)(Pe,{checked:r,amount:n,amountInUSD:i,onCheckboxClick:a,enabledAsCollateral:o,disabled:l,enableAsCollateral:c,isIsolated:d,enteringIsolation:u,borrowApyType:x,userReserve:v,v3Rates:p,showCollateralToggle:M,isSupplyList:j}):(0,xe.jsxs)(Se.H,{sx:{flexDirection:"column",pl:0},"data-cy":"migration-".concat(void 0!==x?"borrow-"+x:"supply","-").concat(v.reserve.symbol),children:[(0,xe.jsxs)(s.Z,{sx:{display:"flex",flexDirection:"row",width:"100%",alignItems:"center",my:4},children:[(0,xe.jsx)(ke.h,{align:"center",maxWidth:64,minWidth:64,children:(0,xe.jsx)(s.Z,{sx:function(e){return{border:"2px solid ".concat(void 0!==l?e.palette.action.disabled:e.palette.text.secondary),background:void 0!==l?e.palette.background.disabled:r?e.palette.text.secondary:e.palette.background.paper,width:16,height:16,borderRadius:"2px","&:hover":{cursor:void 0!==l?"not-allowed":"pointer"},display:"flex",alignItems:"center",justifyContent:"center"}},onClick:void 0!==l?void 0:a,"data-cy":"migration-checkbox",children:void 0===l&&(0,xe.jsx)(G.Z,{sx:{fontSize:"14px",color:"background.paper"},children:(0,xe.jsx)(be.Z,{})})})}),(0,xe.jsxs)(ke.h,{isRow:!0,maxWidth:250,minWidth:170,children:[(0,xe.jsx)(Oe.T1,{symbol:v.reserve.iconSymbol,fontSize:"large"}),(0,xe.jsxs)(s.Z,{sx:{pl:"12px",overflow:"hidden",display:"flex"},children:[(0,xe.jsx)(H.Z,{variant:"subheader1",color:k,noWrap:!0,sx:{pr:1},children:v.reserve.symbol}),void 0!==l&&(0,xe.jsx)(Ze,{dashboardLink:ye.Z6.dashboard+"/?marketName="+y+"_v3",marketName:Z.marketTitle,warningType:l,isolatedV3:!u})]})]}),(0,xe.jsx)(ke.h,{children:(0,xe.jsxs)(s.Z,{sx:{display:"flex"},children:[(0,xe.jsx)(ge.J,{value:I,symbol:v.reserve.symbol,incentives:O,variant:"main14",color:k}),(0,xe.jsx)(G.Z,{sx:{px:1.5},children:(0,xe.jsx)(ee.Z,{fontSize:"14px",color:void 0===l?g.palette.text.primary:g.palette.text.muted})}),(0,xe.jsx)(ge.J,{value:D,symbol:v.reserve.symbol,incentives:B,variant:"main14",color:k})]})}),!!c&&(0,xe.jsx)(ke.h,{children:(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center"},children:[v.usageAsCollateralEnabledOnUser&&"0"!==v.reserve.reserveLiquidationThreshold?(0,xe.jsx)(je.Z,{fontSize:"small",color:"success"}):(0,xe.jsx)(Ie.J,{variant:"main14",color:S}),(0,xe.jsx)(G.Z,{sx:{px:1.5},children:(0,xe.jsx)(ee.Z,{fontSize:"14px",color:void 0===l?g.palette.text.primary:g.palette.text.muted})}),M?(0,xe.jsx)(Be,{enableAsCollateral:c,enabledAsCollateral:o}):o?d?(0,xe.jsxs)(s.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,xe.jsx)(G.Z,{sx:{color:"warning.main",fontSize:"20px"},children:(0,xe.jsx)(me.Z,{})}),(0,xe.jsx)(Ce.Ch,{})]}):(0,xe.jsx)(je.Z,{fontSize:"small",color:"success"}):(0,xe.jsx)(Ie.J,{variant:"main14",color:S})]})}),j&&(A?(0,xe.jsx)(ke.h,{children:(0,xe.jsx)(Ie.J,{variant:"main14",color:"text.secondary"})}):(0,xe.jsx)(ke.h,{children:(0,xe.jsxs)(s.Z,{sx:{display:"flex"},children:[(0,xe.jsx)(Ae.B,{value:v.reserve.formattedBaseLTVasCollateral,percent:!0,variant:"secondary14",color:k}),(0,xe.jsx)(G.Z,{sx:{px:1.5},children:(0,xe.jsx)(ee.Z,{fontSize:"14px",color:void 0===l?g.palette.text.primary:g.palette.text.muted})}),(0,xe.jsx)(Ae.B,{value:(null===p||void 0===p?void 0:p.ltv)||0,percent:!0,variant:"secondary14",color:k})]})})),!!x&&(0,xe.jsx)(ke.h,{children:(0,xe.jsxs)(s.Z,{sx:{display:"flex"},children:[(0,xe.jsx)(J.Z,{variant:"outlined",size:"small",sx:{width:"50px",background:"white"},disabled:!0,children:(0,xe.jsx)(H.Z,{variant:"buttonS",color:k,children:x})}),(0,xe.jsx)(G.Z,{sx:{px:1.5},children:(0,xe.jsx)(ee.Z,{fontSize:"14px",color:void 0===l?g.palette.text.primary:g.palette.text.muted})}),(0,xe.jsx)(J.Z,{variant:"outlined",size:"small",sx:{width:"50px",background:"white"},disabled:!0,children:(0,xe.jsx)(H.Z,{variant:"buttonS",color:k,children:"Variable"})})]})}),!j&&(A?(0,xe.jsx)(ke.h,{children:(0,xe.jsx)(Ie.J,{variant:"main14",color:"text.secondary"})}):(0,xe.jsx)(ke.h,{children:(0,xe.jsxs)(s.Z,{sx:{display:"flex"},children:[(0,xe.jsx)(Ae.B,{value:v.reserve.formattedReserveLiquidationThreshold,percent:!0,variant:"secondary14",color:k}),(0,xe.jsx)(G.Z,{sx:{px:1.5},children:(0,xe.jsx)(ee.Z,{fontSize:"14px",color:void 0===l?g.palette.text.primary:g.palette.text.muted})}),(0,xe.jsx)(Ae.B,{value:null!==(t=null===p||void 0===p?void 0:p.liquidationThreshold)&&void 0!==t?t:-1,percent:!0,variant:"secondary14",color:k})]})})),(0,xe.jsxs)(ke.h,{children:[(0,xe.jsx)(Ae.B,{value:n,variant:"secondary14",color:k}),(0,xe.jsx)(Ae.B,{value:i,variant:"secondary12",color:k,symbol:"USD",symbolsColor:k})]})]}),"stETH"===v.reserve.symbol&&(0,xe.jsx)(s.Z,{sx:{pl:"16px",width:"100%"},children:(0,xe.jsx)(Me,{v2Price:v.reserve.priceInUSD,v2Amount:n,v3Price:null===p||void 0===p?void 0:p.priceInUSD})})]})},Re=function(e){var t=e.selectedBorrowAssets,r=e.userReserve,n=e.toggleSelectedBorrowPosition,i=e.v3Rates,s=e.enteringIsolation,a=(0,l.useMemo)((function(){return!r.migrationDisabled&&t.findIndex((function(e){return r.interestRate==h.tk.Stable?e.debtKey==r.reserve.stableDebtTokenAddress:e.debtKey==r.reserve.variableDebtTokenAddress}))>=0}),[t]),o=r.interestRate==h.tk.Stable?r.stableBorrows:r.variableBorrows,c=r.interestRate==h.tk.Stable?r.stableBorrowsUSD:r.variableBorrowsUSD;return(0,xe.jsx)(Te,{checked:a,userReserve:r,amount:o,amountInUSD:c,onCheckboxClick:function(){n(r)},disabled:r.migrationDisabled,enabledAsCollateral:r.usageAsCollateralEnabledOnUser,borrowApyType:r.interestRate,v3Rates:i,enteringIsolation:s,isSupplyList:!1},r.debtKey)},Ee=function(){var e=(0,L.Z)();return(0,z.Z)(e.breakpoints.down(1125))?(0,xe.jsx)(_e,{}):(0,xe.jsxs)(Se.H,{sx:{pl:0},children:[(0,xe.jsx)(ke.h,{align:"center",maxWidth:64,minWidth:64,children:(0,xe.jsx)(ce.Z,{width:16,height:16})}),(0,xe.jsx)(ke.h,{align:"left",isRow:!0,maxWidth:250,minWidth:170,children:(0,xe.jsxs)(s.Z,{sx:{display:"inline-flex",alignItems:"center"},children:[(0,xe.jsx)(ce.Z,{variant:"circular",width:32,height:32}),(0,xe.jsx)(ce.Z,{sx:{ml:3},width:39,height:20})]})}),(0,xe.jsx)(ke.h,{children:(0,xe.jsx)(ce.Z,{width:120,height:25})}),(0,xe.jsx)(ke.h,{children:(0,xe.jsx)(ce.Z,{width:120,height:25})}),(0,xe.jsx)(ke.h,{children:(0,xe.jsx)(ce.Z,{width:120,height:25})}),(0,xe.jsxs)(ke.h,{children:[(0,xe.jsx)(ce.Z,{width:70,height:16,sx:{mb:1}}),(0,xe.jsx)(ce.Z,{width:50,height:14})]})]})},_e=function(){return(0,xe.jsxs)(Se.H,{sx:{display:"flex",flexDirection:"column",pl:0},children:[(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",width:"100%",pb:2,pt:2.5},children:[(0,xe.jsx)(ke.h,{align:"center",maxWidth:48,minWidth:48,children:(0,xe.jsx)(ce.Z,{width:16,height:16})}),(0,xe.jsx)(ke.h,{align:"left",children:(0,xe.jsxs)(s.Z,{sx:{display:"inline-flex",alignItems:"center"},children:[(0,xe.jsx)(ce.Z,{variant:"circular",width:32,height:32}),(0,xe.jsx)(ce.Z,{sx:{ml:3},width:39,height:20})]})})]}),(0,xe.jsxs)(s.Z,{sx:{width:"100%",display:"flex",flexDirection:"column",gap:2,pb:4,pl:12},children:[(0,xe.jsxs)(s.Z,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,xe.jsx)(ce.Z,{width:130,height:16}),(0,xe.jsxs)(s.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:1},children:[(0,xe.jsx)(ce.Z,{width:50,height:16}),(0,xe.jsx)(ce.Z,{width:30,height:14})]})]}),(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,xe.jsx)(ce.Z,{width:80,height:16}),(0,xe.jsx)(ce.Z,{width:115,height:16})]}),(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,xe.jsx)(ce.Z,{width:115,height:16}),(0,xe.jsx)(ce.Z,{width:150,height:16})]}),(0,xe.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,xe.jsx)(ce.Z,{width:140,height:16}),(0,xe.jsx)(ce.Z,{width:115,height:16})]})]})]})},Fe=r(99435),Ue=r(1475),Ve=r(45556),Ne=r(32374);function Le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ze(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var We=function(e){var t=e.numSelected,r=e.allSelected,n=e.onSelectAllClick,i=e.disabled,a=(0,L.Z)(),o={border:"2px solid ".concat(a.palette.text.secondary),background:a.palette.text.secondary,width:16,height:16,borderRadius:"2px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"};return i?(0,xe.jsx)(Fe.M,{children:(0,xe.jsx)(s.Z,{sx:ze(ze({},o),{},{background:a.palette.action.disabledBackground,border:"2px solid ".concat(a.palette.action.disabled),"&:hover":{cursor:"not-allowed"}})})}):(0,xe.jsx)(Fe.M,{onClick:n,children:r?(0,xe.jsx)(s.Z,{sx:o,"data-cy":"migration-checkbox-all",children:(0,xe.jsx)(G.Z,{sx:{fontSize:"14px",color:"background.paper"},children:(0,xe.jsx)(be.Z,{})})}):0!==t?(0,xe.jsx)(s.Z,{sx:o,"data-cy":"migration-checkbox-all",children:(0,xe.jsx)(G.Z,{sx:{fontSize:"16px",color:"background.paper"},children:(0,xe.jsx)(Ne.Z,{})})}):(0,xe.jsx)(s.Z,{sx:ze(ze({},o),{},{background:"white"}),"data-cy":"migration-checkbox-all"})})},Ye=function(e){var t=e.titleComponent,r=e.children,n=e.onSelectAllClick,a=e.loading,o=e.isAvailable,l=e.allSelected,c=e.numSelected,d=e.numAvailable,u=e.disabled;return(0,xe.jsx)(s.Z,{sx:{width:"100%"},children:(0,xe.jsxs)(Ve.l,{titleComponent:(0,xe.jsx)(H.Z,{component:"div",variant:"h3",sx:{mr:4},children:t}),children:[(o||a)&&(0,xe.jsxs)(Ue.u,{sx:{pl:0},children:[(0,xe.jsx)(ke.h,{align:"center",maxWidth:48,minWidth:48,children:(0,xe.jsx)(We,{allSelected:l,numSelected:c,onSelectAllClick:n,disabled:u})}),(0,xe.jsx)(s.Z,{sx:{height:22,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,xe.jsx)(H.Z,{variant:"subheader2",color:"text.secondary",children:(0,xe.jsx)(i.cC,{id:"{numSelected}/{numAvailable} assets selected",values:{numSelected:c,numAvailable:d}})})})]}),r]})})},qe=[{title:(0,xe.jsx)(i.cC,{id:"APY change"})},{title:(0,xe.jsx)(i.cC,{id:"Collateral change"})},{title:(0,xe.jsx)(i.cC,{id:"Max LTV"})},{title:(0,xe.jsx)(i.cC,{id:"Current v2 balance"})}],He=[{title:(0,xe.jsx)(i.cC,{id:"APY change"})},{title:(0,xe.jsx)(i.cC,{id:"APY type change"})},{title:(0,xe.jsx)(i.cC,{id:"Liquidation Threshold"})},{title:(0,xe.jsx)(i.cC,{id:"Current v2 balance"})}],Je=function(e){var t=e.titleComponent,r=e.children,n=e.onSelectAllClick,a=e.loading,o=e.isAvailable,l=e.withCollateral,c=e.withBorrow,d=e.allSelected,u=e.numSelected,x=e.numAvailable,h=e.disabled,v=e.isolatedReserveV3,p=(0,L.Z)(),m=(0,w.Y)(),b=m.currentMarket,j=m.currentMarketData.marketTitle,g=ye.Z6.dashboard+"/?marketName="+b+"_v3";return(0,z.Z)(p.breakpoints.down(1125))?(0,xe.jsx)(Ye,{titleComponent:t,onSelectAllClick:n,loading:a,isAvailable:o,allSelected:d,numSelected:u,disabled:h,numAvailable:x,children:r}):(0,xe.jsx)(s.Z,{sx:{width:"100%"},children:(0,xe.jsxs)(Ve.l,{paperSx:{border:0,boxShadow:"none"},titleComponent:(0,xe.jsxs)(s.Z,{display:"block",children:[(0,xe.jsx)(H.Z,{component:"div",variant:"subheader2",sx:{mr:4},children:t}),v&&!v.enteringIsolationMode&&(0,xe.jsx)(s.Z,{sx:{pt:"16px"},children:(0,xe.jsx)(X.v,{severity:"warning",icon:!1,sx:{mb:0},children:(0,xe.jsx)(H.Z,{variant:"caption",color:p.palette.warning[100],children:(0,xe.jsx)(i.cC,{id:"Some migrated assets will not be used as collateral due to enabled isolation mode in {marketName} V3 Market. Visit <0>{marketName} V3 Dashboard</0> to manage isolation mode.",values:{marketName:j},components:{0:(0,xe.jsx)(ye.rU,{href:g})}})})})})]}),children:[(o||a)&&(0,xe.jsxs)(Ue.u,{sx:{pl:0},children:[(0,xe.jsx)(ke.h,{align:"center",maxWidth:64,minWidth:64,children:(0,xe.jsx)(We,{allSelected:d,numSelected:u,onSelectAllClick:n,disabled:h})}),(0,xe.jsx)(ke.h,{isRow:!0,maxWidth:250,minWidth:170,children:(0,xe.jsx)(Fe.M,{children:(0,xe.jsx)(i.cC,{id:"Assets"})})}),l&&qe.map((function(e,t){return(0,xe.jsx)(ke.h,{children:(0,xe.jsx)(Fe.M,{children:e.title})},t)})),c&&He.map((function(e,t){return(0,xe.jsx)(ke.h,{children:(0,xe.jsx)(Fe.M,{children:e.title})},t)}))]}),r]})})},Ge=function(e){var t=e.onSelectAllSupplies,r=e.onSelectAllBorrows,n=e.suppliesPositions,s=e.borrowsPositions,a=e.loading,o=e.isolatedReserveV3,l=e.isSupplyPositionsAvailable,c=e.isBorrowPositionsAvailable,d=e.emodeCategoryId,u=e.supplyReserves,x=e.borrowReserves,h=(0,w.Y)(),v=h.selectedMigrationSupplyAssets,p=h.selectedMigrationBorrowAssets,m=void 0===u.find((function(e){return void 0===e.migrationDisabled})),b=void 0===x.find((function(e){return void 0===e.migrationDisabled})),j=(0,Z.FW)(u,v),g=j.activeSelections,f=j.activeUnselected,y=(0,Z.FW)(x,p),C=y.activeSelections,k=y.activeUnselected;return(0,xe.jsxs)(W.Z,{sx:{display:"flex",flexDirection:"column",gap:2,width:"100%"},children:[(0,xe.jsx)(H.Z,{variant:"h3",sx:{p:{xs:"16px 24px 0 24px"},display:{xs:"none",lg:"block"}},children:"Assets to migrate"}),(0,xe.jsx)(Je,{isolatedReserveV3:o,loading:a,onSelectAllClick:t,allSelected:0===f.length,isAvailable:l,titleComponent:(0,xe.jsx)(i.cC,{id:"Supplied assets"}),emodeCategoryId:d,withCollateral:!0,disabled:m,numSelected:g.length||0,numAvailable:u.length||0,children:n}),(0,xe.jsx)(Je,{loading:a,onSelectAllClick:r,allSelected:0===k.length,isAvailable:c,withBorrow:!0,disabled:b,titleComponent:(0,xe.jsx)(i.cC,{id:"Borrowed assets"}),numSelected:C.length||0,numAvailable:x.length||0,children:s})]})},Ke=r(96471),Xe=r(74815),Qe=function(){var e=(0,o.useRouter)(),t=(0,L.Z)(),r=(0,z.Z)(t.breakpoints.down("sm"));return(0,xe.jsx)(Xe.f,{titleComponent:(0,xe.jsx)(s.Z,{children:(0,xe.jsx)(s.Z,{sx:{display:"flex",alignItems:r?"flex-start":"center",alignSelf:r?"flex-start":"center",mb:4,minHeight:"40px",flexDirection:r?"column":"row"},children:(0,xe.jsx)(J.Z,{variant:"surface",size:"medium",color:"primary",startIcon:(0,xe.jsx)(G.Z,{sx:{fontSize:"20px"},children:(0,xe.jsx)(Ke.Z,{})}),onClick:function(){e.push(ye.Z6.dashboard)},sx:{mr:3,mb:r?"24px":"0"},"data-cy":"goBack-btn",children:(0,xe.jsx)(i.cC,{id:"Go Back"})})})})})};function $e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var et=(0,a.default)((function(){return Promise.all([r.e(4254),r.e(1573),r.e(7399)]).then(r.bind(r,99528)).then((function(e){return e.MigrateV3Modal}))}),{loadableGenerated:{webpack:function(){return[99528]}}}),tt=Object.keys(ue.ei).map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},ue.ei[e])})).filter((function(e){return e.addresses.V3_MIGRATOR})),rt=[{title:"Aave V2 Markets",markets:tt}];function nt(){var e=(0,F.Z)(),t=e.currentAccount,r=e.loading,n=(0,o.useRouter)(),a=(0,l.useState)((function(){if(n.query.market){var e=(0,u.hu)(n.query.market).market;if(tt.find((function(t){return t.isFork===e.isFork&&t.chainId===e.chainId})))return e}return tt[0]})),h=a[0],v=a[1],p=(0,w.Y)(),m=p.selectAllSupply,b=p.selectAllBorrow,j=p.toggleMigrationSelectedSupplyAsset,g=p.selectedMigrationSupplyAssets,f=p.toggleMigrationSelectedBorrowAsset,Z=p.selectedMigrationBorrowAssets,S=p.resetMigrationSelectedAssets,A=p.enforceAsCollateral,O=(0,y.xI)(h.chainId,(0,ue.Mo)(h.chainId)),M=(0,x.C)(h,O),P=M.data,T=M.isLoading,_=(null===P||void 0===P?void 0:P.supplyReserves)||[],V=(null===P||void 0===P?void 0:P.borrowReserves)||[],N=null===P||void 0===P?void 0:P.isolatedReserveV3,L=(0,E.g)(h),z=L.data,W=L.isLoading,Y=(0,I.T)(O),q=Y.data,H=Y.isLoading,J=(0,E.g)(O),G=J.data,K=J.isLoading,X=(null===q||void 0===q?void 0:q.userEmodeCategoryId)||0,Q=function(e,t){var r,n=(0,x.C)(e,t),i=(0,B.D)(t),s=D(e),a=D(t),o=(0,k.p)(e,t,null===(r=n.data)||void 0===r?void 0:r.supplyReserves),l=(0,w.Y)((function(e){return e.selectedMigrationBorrowAssets})),c=(0,w.Y)((function(e){return e.selectedMigrationSupplyAssets}));return(0,C.W)([n,s,a,i,o],(function(e,t,r,n,i){return R(e,t,r,n,c,l,i)}))}(h,O),$=Q.data,ee=Q.isLoading,te=T||W||H||K||ee;(0,l.useEffect)((function(){S&&S()}),[S]);var re=g.length>1&&G&&"0"==G.totalCollateralMarketReferenceCurrency,ne=z&&G&&{fromUserSummaryBeforeMigration:z,toUserSummaryBeforeMigration:G};return(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)(Qe,{}),t?(0,xe.jsx)(d.O,{children:(0,xe.jsxs)(s.Z,{sx:{display:"flex",gap:4,alignItems:"start",flexDirection:{xs:"column",lg:"row"}},children:[(0,xe.jsx)(pe,{userSummaryAfterMigration:$,userSummaryBeforeMigration:ne,disableButton:0===g.length&&0===Z.length,enteringIsolationMode:(null===N||void 0===N?void 0:N.enteringIsolationMode)||!1,loading:te,fromMarketData:h,toMarketData:O,setFromMarketData:function(e){S(),v(e)},selectableMarkets:rt}),(0,xe.jsx)(Ge,{loading:te,isSupplyPositionsAvailable:_.length>0,isBorrowPositionsAvailable:V.length>0,onSelectAllSupplies:function(){m(_)},onSelectAllBorrows:function(){b(V)},emodeCategoryId:X,isolatedReserveV3:N,supplyReserves:_,borrowReserves:V,suppliesPositions:(0,xe.jsx)(xe.Fragment,{children:te?(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)(Ee,{}),(0,xe.jsx)(Ee,{})]}):_.length>0?_.map((function(e){return(0,xe.jsx)(Te,{checked:g.findIndex((function(t){return t.underlyingAsset==e.underlyingAsset}))>=0,enableAsCollateral:function(){return t=e.canBeEnforced,r=e.underlyingAsset,void(t&&A(r));var t,r},userControlledCollateral:re,canBeEnforced:G&&"0"==G.totalCollateralMarketReferenceCurrency&&e.canBeEnforced,userReserve:e,amount:e.underlyingBalance,amountInUSD:e.underlyingBalanceUSD,onCheckboxClick:function(){j(e.underlyingAsset)},enabledAsCollateral:e.usageAsCollateralEnabledOnUserV3,isIsolated:e.isolatedOnV3,enteringIsolation:(null===N||void 0===N?void 0:N.enteringIsolationMode)||!1,v3Rates:e.v3Rates,disabled:e.migrationDisabled,isSupplyList:!0},e.underlyingAsset)})):(0,xe.jsx)(s.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,xe.jsx)(U.N,{text:(0,xe.jsx)(i.cC,{id:"Nothing supplied yet"})})})}),borrowsPositions:(0,xe.jsx)(xe.Fragment,{children:te?(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)(Ee,{}),(0,xe.jsx)(Ee,{})]}):V.length>0?V.map((function(e){return(0,xe.jsx)(Re,{userReserve:e,selectedBorrowAssets:Z,toggleSelectedBorrowPosition:f,v3Rates:e.v3Rates,enteringIsolation:(null===N||void 0===N?void 0:N.enteringIsolationMode)||!1},e.debtKey)})):(0,xe.jsx)(s.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,xe.jsx)(U.N,{text:(0,xe.jsx)(i.cC,{id:"Nothing borrowed yet"})})})})})]})}):(0,xe.jsx)(c.w,{loading:r,description:(0,xe.jsx)(i.cC,{id:"Please connect your wallet to see migration tool."})})]})}nt.getLayout=function(e){return(0,xe.jsxs)(_.Z,{children:[e,(0,xe.jsx)(et,{})]})}},96875:function(e,t,r){"use strict";r.d(t,{o:function(){return b}});var n=r(59499),i=r(4730),s=r(49501),a=r(1279),o=r(62097),l=r(30120),c=r(29630),d=r(75084),u=r(70794),x=r(41024),h=r(85893),v=["value","onInfoClick","HALIntegrationComponent"];function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var b=function(e){var t=e.value,r=e.onInfoClick,n=e.HALIntegrationComponent,p=(0,i.Z)(e,v),b=(0,o.Z)().palette,j=Number((0,a.hE)(t).toFixed(2,u.Z.ROUND_DOWN)),g="";return g=j>=3?b.success.main:j<1.1?b.error.main:b.warning.main,(0,h.jsxs)(l.Z,{sx:{display:"inline-flex",alignItems:{xs:"flex-start",xsm:"center"},flexDirection:{xs:"column",xsm:"row"}},"data-cy":"HealthFactorTopPannel",children:["-1"===t?(0,h.jsx)(c.Z,{variant:"secondary14",color:b.success.main,children:"\u221e"}):(0,h.jsx)(x.B,m({value:j,sx:m({color:g},p.sx),visibleDecimals:2,compact:!0},p)),r&&(0,h.jsx)(d.Z,{onClick:r,variant:"surface",size:"small",sx:{minWidth:"unset",ml:{xs:0,xsm:2}},children:(0,h.jsx)(s.cC,{id:"Risk details"})}),n&&(0,h.jsx)(l.Z,{ml:{xs:0,xsm:2},mt:{xs:1,xsm:0},children:n})]})}},18384:function(e,t,r){"use strict";r.d(t,{i:function(){return l}});var n=r(49501),i=r(29630),s=r(68861),a=r(69331),o=r(85893),l=function(e){var t=e.asset,r=e.severity;return(0,o.jsxs)(a.v,{severity:r||"info",sx:{mb:3},children:[(0,o.jsx)(i.Z,{variant:"subheader1",mb:.5,children:(0,o.jsx)(n.cC,{id:"You are entering Isolation mode"})}),(0,o.jsx)(i.Z,{children:(0,o.jsx)(n.cC,{id:"In Isolation mode, you cannot supply other assets as collateral. A global debt ceiling limits the borrowing power of the isolated asset. To exit isolation mode disable {0} as collateral before borrowing another asset. Read more in our <0>FAQ</0>",values:{0:t||""},components:{0:(0,o.jsx)(s.rU,{href:"https://docs.aave.com/faq/aave-v3-features#isolation-mode"})}})})]})}},63263:function(e,t,r){"use strict";r.d(t,{p:function(){return o}});var n=r(36492),i=r(31001),s=r(8430),a=r(38776),o=function(e,t,r){var o=(0,s.z)().migrationService;return(0,n.a)({queryKey:i.B.migrationExceptions(r||[],e,t),queryFn:function(){return(0,a.Z)(r,"Supply exceptions are required"),o.getMigrationExceptionSupplyBalances(r,e,t)},enabled:!!r})}},15070:function(e,t,r){"use strict";r.d(t,{C:function(){return C}});var n=r(59499),i=r(4730),s=r(80854),a=r(1279),o=r(27484),l=r.n(o),c=r(42568),d=r.n(c),u=r(78371),x=r(67728),h=r(52369),v=r(37197),p=r(45104),m=r(55774),b=r(25957),j=r(63263),g=["userReservesData"],f=["userReservesData"];function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Z=d()((function(e,t,r,n,o,c){var d=(0,x.qt)(e.reservesData,r,t.userReserves,e.baseCurrencyData,l()().unix(),t.userEmodeCategoryId),u=d.userReservesData,h=(0,i.Z)(d,g),v=n.userReservesData,p=(0,i.Z)(n,f),m=t.userEmodeCategoryId,b=(0,x.IM)(h),j=(0,x.NK)(u);if("0"==h.totalCollateralMarketReferenceCurrency){var y=(0,x.Cz)(c,o,j);if(y.length>0){var Z=(0,x.HX)(o,y[0]),C=j[Z];"0"!==C.reserve.reserveLiquidationThreshold&&C.reserve.isIsolated&&(b=w(w({},C.reserve),{},{enteringIsolationMode:!0}))}}var k=v.filter((function(e){return"0"!==e.underlyingBalance})),S=(0,x.GZ)(v),A=k.map((function(e){var t,r,n,i,s=!0,l=(0,x.HX)(o,e),c=null===(t=j[l])||void 0===t?void 0:t.reserve.isIsolated,d="0"==(null===(r=j[l])||void 0===r?void 0:r.underlyingBalance),u=j[l];if(u){var h=(0,a.hE)(u.reserve.supplyCap).minus(u.reserve.totalLiquidity),v=u.reserve.formattedBaseLTVasCollateral;0!==m&&u.reserve.eModeCategoryId!==m&&(v=u.reserve.formattedEModeLtv),i={stableBorrowAPY:u.stableBorrowAPY,variableBorrowAPY:u.reserve.variableBorrowAPY,supplyAPY:u.reserve.supplyAPY,aIncentivesData:u.reserve.aIncentivesData,vIncentivesData:u.reserve.vIncentivesData,sIncentivesData:u.reserve.sIncentivesData,priceInUSD:u.reserve.priceInUSD,ltv:v},u.reserve.isFrozen?n=x.b_.ReserveFrozen:h.isGreaterThan(e.underlyingBalance)||(n=x.b_.NotEnoughtSupplies)}else n=x.b_.V3AssetMissing;return s=b?e.underlyingAsset==b.underlyingAsset:"0"!==(null===u||void 0===u?void 0:u.underlyingBalance)?null===u||void 0===u?void 0:u.usageAsCollateralEnabledOnUser:!c,w(w({},e),{},{usageAsCollateralEnabledOnUserV3:s,isolatedOnV3:c,canBeEnforced:d,migrationDisabled:n,v3Rates:i})})),I=S.map((function(e){var t,r,n,i=null===(t=j[e.underlyingAsset])||void 0===t?void 0:t.reserve;b&&!i.borrowableInIsolation&&(r=x.b_.IsolationModeBorrowDisabled);var o=j[e.underlyingAsset];if(o){var l=o.reserve.formattedReserveLiquidationThreshold;0!==m&&(null===i||void 0===i?void 0:i.eModeCategoryId)!==m&&(r=x.b_.EModeBorrowDisabled,l=o.reserve.formattedEModeLiquidationThreshold),n={stableBorrowAPY:o.stableBorrowAPY,variableBorrowAPY:o.reserve.variableBorrowAPY,supplyAPY:o.reserve.stableBorrowAPY,aIncentivesData:o.reserve.aIncentivesData,vIncentivesData:o.reserve.vIncentivesData,sIncentivesData:o.reserve.sIncentivesData,priceInUSD:o.reserve.priceInUSD,liquidationThreshold:l},(0,a.hE)((0,s.gU)(e.increasedStableBorrows,e.reserve.decimals)).plus((0,s.gU)(e.increasedVariableBorrows,e.reserve.decimals)).isGreaterThan(o.reserve.availableLiquidity)?r=x.b_.InsufficientLiquidity:o.reserve.flashLoanEnabled?o.reserve.isFrozen&&(r=x.b_.ReserveFrozen):r=x.b_.AssetNotFlashloanable}else r=x.b_.V3AssetMissing;return w(w({},e),{},{v3Rates:n,migrationDisabled:r})}));return{totalCollateralUSD:p.totalCollateralUSD,totalBorrowsUSD:p.totalBorrowsUSD,healthFactor:p.healthFactor,borrowReserves:I,supplyReserves:A,isolatedReserveV3:b}})),C=function(e,t){var r,n=(0,h.J)(t),i=(0,p.T)(t),s=(0,v.O)(t),a=(0,m.g)(e),o=null===(r=a.data)||void 0===r?void 0:r.userReservesData,l=null===o||void 0===o?void 0:o.filter((function(e){return"0"!==e.underlyingBalance})),c=(0,j.p)(e,t,l),d=(0,u.Y)((function(e){return e.selectedMigrationSupplyAssets}));return(0,b.W)([n,i,s,a,c],(function(e,t,r,n,i){return Z(e,t,r,n,i,d)}))}},49258:function(e,t,r){"use strict";r.d(t,{D:function(){return h}});var n=r(27484),i=r.n(n),s=r(42568),a=r.n(s),o=r(67728),l=r(52369),c=r(37197),d=r(45104),u=r(25957),x=a()((function(e,t,r){return(0,o.qt)(e.reservesData,r,t.userReserves,e.baseCurrencyData,i()().unix(),t.userEmodeCategoryId)})),h=function(e){var t=(0,l.J)(e),r=(0,d.T)(e),n=(0,c.O)(e);return(0,u.W)([t,r,n],x)}},26079:function(e,t,r){"use strict";r.d(t,{N:function(){return a}});var n=r(30120),i=r(29630),s=r(85893),a=function(e){var t=e.text;return(0,s.jsx)(n.Z,{sx:{px:{xs:4,xsm:6},pt:{xs:3.5,xsm:5.5},pb:{xs:6,sxm:7}},children:(0,s.jsx)(i.Z,{color:"text.secondary",children:t})})}},79340:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/v3-migration",function(){return r(40342)}])}},function(e){e.O(0,[1506,1102,4815,8019,5599,5315,9774,2888,179],(function(){return t=79340,e(e.s=t);var t}));var t=e.O();_N_E=t}]);