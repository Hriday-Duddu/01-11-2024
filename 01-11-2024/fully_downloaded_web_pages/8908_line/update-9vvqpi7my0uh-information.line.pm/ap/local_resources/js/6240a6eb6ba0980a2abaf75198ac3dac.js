(()=>{var ae={localStorage:Ct("localStorage"),sessionStorage:Ct("sessionStorage")},ft=t=>t instanceof ShadowRoot&&t.host;function N(t,e){for(;t.matches&&!t.matches(e)||ft(t);)ft(t)?t=t.host:t=t.parentNode;return t.matches?t:null}function dt(t,e,r){return r===void 0?r=[]:t!==e&&r.push(t),t!==e?(ft(t)?t=t.host:t=t.parentNode,dt(t,e,r)):r}var jt=(t,e)=>{let r;if(ae[e]){r=window[e].getItem(`_dl${t}State`);try{r=JSON.parse(r||"{}")}catch{r={}}r.save=()=>{window[e].setItem(`_dl${t}State`,JSON.stringify(r))}}else r={},r.save=()=>{};return r.init=(a,i)=>(r[a]=r[a]!==void 0?r[a]:i,r[a]),r},L=jt("","sessionStorage"),S=jt("Local","localStorage");var gi=(t,e)=>t!=null?t==="true"?!0:t==="false"?!1:t.split("|").map(r=>r==="core"?"Data Layer":r):window.trackingDebug||e;window.trackingDebug=ie("trackingDebug",gi)(window.location.href);var x={debug(){if(window.trackingDebug){if(Array.isArray(window.trackingDebug)&&window.trackingDebug.map(r=>r.toLowerCase()).indexOf(this._id.toLowerCase())===-1)return;var t=[...arguments],e=this.debugHeader||this._id;this.debugParams&&this.debugParams.length&&(e+=` (${this.debugParams.join(", ")})`),console.groupCollapsed?(console.groupCollapsed(`${e}: `),console.log.apply(this,t),console.groupEnd()):(t.unshift(`${e}: `),console.log.apply(this,t))}}};function Le(t){return["resi_myaccount_2","resi_cpp","resi_cpp_2","resi_support_2"].indexOf(t)>=0}function Ce(t){return["idm","login","resi_buyflow","resi_buyflow_agent","resi_buyflow_approval","resi_shop","resi_shop_2","resi_shop_agent","resi_shop_ancillary","resi_store"].indexOf(t)>=0}function Nt(t){return["celestial"].indexOf(t)>=0}function P(){return document.currentScript}function v(t,e){if(!e)return;let r=U(e).search.toLowerCase();return new URLSearchParams(r).get(t.toLowerCase())}function ie(t,e){return function(a){L.init(t,!1);let i=v(t,a);return L[t]=e(i,L[t]),L.save(),L[t]}}function U(t){try{if(t&&typeof t=="string"){let e=document.createElement("a");return e.href=t,{hostname:e.hostname,pathname:e.pathname,search:e.search,hash:e.hash}}}catch{}return{}}function Ct(t){try{var e=window[t],r="__storage_test__";return e.setItem(r,r),e.removeItem(r),!0}catch(a){return a instanceof DOMException&&(a.code===22||a.code===1014||a.name==="QuotaExceededError"||a.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e.length!==0}}var bi=typeof global=="object"&&global&&global.Object===Object&&global,je=bi;var yi=typeof self=="object"&&self&&self.Object===Object&&self,xi=je||yi||Function("return this")(),_=xi;var _i=_.Symbol,D=_i;var Rt=Object.prototype,wi=Rt.hasOwnProperty,vi=Rt.toString,Se=D?D.toStringTag:void 0;function Ei(t){var e=wi.call(t,Se),r=t[Se];try{t[Se]=void 0;var a=!0}catch{}var i=vi.call(t);return a&&(e?t[Se]=r:delete t[Se]),i}var Mt=Ei;var Ii=Object.prototype,Si=Ii.toString;function Ai(t){return Si.call(t)}var Bt=Ai;var Oi="[object Null]",Pi="[object Undefined]",Ut=D?D.toStringTag:void 0;function Di(t){return t==null?t===void 0?Pi:Oi:Ut&&Ut in Object(t)?Mt(t):Bt(t)}var A=Di;function Ti(t){return t!=null&&typeof t=="object"}var E=Ti;var ki="[object Symbol]";function Li(t){return typeof t=="symbol"||E(t)&&A(t)==ki}var G=Li;function Ci(t,e){for(var r=-1,a=t==null?0:t.length,i=Array(a);++r<a;)i[r]=e(t[r],r,t);return i}var se=Ci;var ji=Array.isArray,b=ji;var Ni=1/0,Gt=D?D.prototype:void 0,Wt=Gt?Gt.toString:void 0;function qt(t){if(typeof t=="string")return t;if(b(t))return se(t,qt)+"";if(G(t))return Wt?Wt.call(t):"";var e=t+"";return e=="0"&&1/t==-Ni?"-0":e}var Ft=qt;var Ri=/\s/;function Mi(t){for(var e=t.length;e--&&Ri.test(t.charAt(e)););return e}var Ht=Mi;var Bi=/^\s+/;function Ui(t){return t&&t.slice(0,Ht(t)+1).replace(Bi,"")}var $t=Ui;function Gi(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var y=Gi;var Vt=NaN,Wi=/^[-+]0x[0-9a-f]+$/i,qi=/^0b[01]+$/i,Fi=/^0o[0-7]+$/i,Hi=parseInt;function $i(t){if(typeof t=="number")return t;if(G(t))return Vt;if(y(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=y(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=$t(t);var r=qi.test(t);return r||Fi.test(t)?Hi(t.slice(2),r?2:8):Wi.test(t)?Vt:+t}var Kt=$i;var Jt=1/0,Vi=17976931348623157e292;function Ki(t){if(!t)return t===0?t:0;if(t=Kt(t),t===Jt||t===-Jt){var e=t<0?-1:1;return e*Vi}return t===t?t:0}var Qt=Ki;function Ji(t){var e=Qt(t),r=e%1;return e===e?r?e-r:e:0}var zt=Ji;function Qi(t){return t}var oe=Qi;var zi="[object AsyncFunction]",Xi="[object Function]",Yi="[object GeneratorFunction]",Zi="[object Proxy]";function es(t){if(!y(t))return!1;var e=A(t);return e==Xi||e==Yi||e==zi||e==Zi}var ne=es;var ts=_["__core-js_shared__"],Ne=ts;var Xt=function(){var t=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function rs(t){return!!Xt&&Xt in t}var Yt=rs;var as=Function.prototype,is=as.toString;function ss(t){if(t!=null){try{return is.call(t)}catch{}try{return t+""}catch{}}return""}var R=ss;var os=/[\\^$.*+?()[\]{}|]/g,ns=/^\[object .+?Constructor\]$/,fs=Function.prototype,ds=Object.prototype,us=fs.toString,ps=ds.hasOwnProperty,ls=RegExp("^"+us.call(ps).replace(os,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function cs(t){if(!y(t)||Yt(t))return!1;var e=ne(t)?ls:ns;return e.test(R(t))}var Zt=cs;function ms(t,e){return t?.[e]}var er=ms;function hs(t,e){var r=er(t,e);return Zt(r)?r:void 0}var O=hs;var gs=O(_,"WeakMap"),Re=gs;var tr=Object.create,bs=function(){function t(){}return function(e){if(!y(e))return{};if(tr)return tr(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),rr=bs;function ys(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var ar=ys;function xs(t,e){var r=-1,a=t.length;for(e||(e=Array(a));++r<a;)e[r]=t[r];return e}var ir=xs;var _s=800,ws=16,vs=Date.now;function Es(t){var e=0,r=0;return function(){var a=vs(),i=ws-(a-r);if(r=a,i>0){if(++e>=_s)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var sr=Es;function Is(t){return function(){return t}}var or=Is;var Ss=function(){try{var t=O(Object,"defineProperty");return t({},"",{}),t}catch{}}(),fe=Ss;var As=fe?function(t,e){return fe(t,"toString",{configurable:!0,enumerable:!1,value:or(e),writable:!0})}:oe,nr=As;var Os=sr(nr),fr=Os;function Ps(t,e,r,a){for(var i=t.length,s=r+(a?1:-1);a?s--:++s<i;)if(e(t[s],s,t))return s;return-1}var dr=Ps;function Ds(t){return t!==t}var ur=Ds;function Ts(t,e,r){for(var a=r-1,i=t.length;++a<i;)if(t[a]===e)return a;return-1}var pr=Ts;function ks(t,e,r){return e===e?pr(t,e,r):dr(t,ur,r)}var lr=ks;var Ls=9007199254740991,Cs=/^(?:0|[1-9]\d*)$/;function js(t,e){var r=typeof t;return e=e??Ls,!!e&&(r=="number"||r!="symbol"&&Cs.test(t))&&t>-1&&t%1==0&&t<e}var W=js;function Ns(t,e,r){e=="__proto__"&&fe?fe(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var de=Ns;function Rs(t,e){return t===e||t!==t&&e!==e}var C=Rs;var Ms=Object.prototype,Bs=Ms.hasOwnProperty;function Us(t,e,r){var a=t[e];(!(Bs.call(t,e)&&C(a,r))||r===void 0&&!(e in t))&&de(t,e,r)}var Me=Us;function Gs(t,e,r,a){var i=!r;r||(r={});for(var s=-1,f=e.length;++s<f;){var o=e[s],d=a?a(r[o],t[o],o,r,t):void 0;d===void 0&&(d=t[o]),i?de(r,o,d):Me(r,o,d)}return r}var Be=Gs;var cr=Math.max;function Ws(t,e,r){return e=cr(e===void 0?t.length-1:e,0),function(){for(var a=arguments,i=-1,s=cr(a.length-e,0),f=Array(s);++i<s;)f[i]=a[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=a[i];return o[e]=r(f),ar(t,this,o)}}var mr=Ws;function qs(t,e){return fr(mr(t,e,oe),t+"")}var hr=qs;var Fs=9007199254740991;function Hs(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Fs}var ue=Hs;function $s(t){return t!=null&&ue(t.length)&&!ne(t)}var T=$s;function Vs(t,e,r){if(!y(r))return!1;var a=typeof e;return(a=="number"?T(r)&&W(e,r.length):a=="string"&&e in r)?C(r[e],t):!1}var gr=Vs;function Ks(t){return hr(function(e,r){var a=-1,i=r.length,s=i>1?r[i-1]:void 0,f=i>2?r[2]:void 0;for(s=t.length>3&&typeof s=="function"?(i--,s):void 0,f&&gr(r[0],r[1],f)&&(s=i<3?void 0:s,i=1),e=Object(e);++a<i;){var o=r[a];o&&t(e,o,a,s)}return e})}var pe=Ks;var Js=Object.prototype;function Qs(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Js;return t===r}var le=Qs;function zs(t,e){for(var r=-1,a=Array(t);++r<t;)a[r]=e(r);return a}var br=zs;var Xs="[object Arguments]";function Ys(t){return E(t)&&A(t)==Xs}var ut=Ys;var yr=Object.prototype,Zs=yr.hasOwnProperty,eo=yr.propertyIsEnumerable,to=ut(function(){return arguments}())?ut:function(t){return E(t)&&Zs.call(t,"callee")&&!eo.call(t,"callee")},X=to;function ro(){return!1}var xr=ro;var vr=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_r=vr&&typeof module=="object"&&module&&!module.nodeType&&module,ao=_r&&_r.exports===vr,wr=ao?_.Buffer:void 0,io=wr?wr.isBuffer:void 0,so=io||xr,Y=so;var oo="[object Arguments]",no="[object Array]",fo="[object Boolean]",uo="[object Date]",po="[object Error]",lo="[object Function]",co="[object Map]",mo="[object Number]",ho="[object Object]",go="[object RegExp]",bo="[object Set]",yo="[object String]",xo="[object WeakMap]",_o="[object ArrayBuffer]",wo="[object DataView]",vo="[object Float32Array]",Eo="[object Float64Array]",Io="[object Int8Array]",So="[object Int16Array]",Ao="[object Int32Array]",Oo="[object Uint8Array]",Po="[object Uint8ClampedArray]",Do="[object Uint16Array]",To="[object Uint32Array]",g={};g[vo]=g[Eo]=g[Io]=g[So]=g[Ao]=g[Oo]=g[Po]=g[Do]=g[To]=!0;g[oo]=g[no]=g[_o]=g[fo]=g[wo]=g[uo]=g[po]=g[lo]=g[co]=g[mo]=g[ho]=g[go]=g[bo]=g[yo]=g[xo]=!1;function ko(t){return E(t)&&ue(t.length)&&!!g[A(t)]}var Er=ko;function Lo(t){return function(e){return t(e)}}var Ir=Lo;var Sr=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ae=Sr&&typeof module=="object"&&module&&!module.nodeType&&module,Co=Ae&&Ae.exports===Sr,pt=Co&&je.process,jo=function(){try{var t=Ae&&Ae.require&&Ae.require("util").types;return t||pt&&pt.binding&&pt.binding("util")}catch{}}(),lt=jo;var Ar=lt&&lt.isTypedArray,No=Ar?Ir(Ar):Er,ce=No;var Ro=Object.prototype,Mo=Ro.hasOwnProperty;function Bo(t,e){var r=b(t),a=!r&&X(t),i=!r&&!a&&Y(t),s=!r&&!a&&!i&&ce(t),f=r||a||i||s,o=f?br(t.length,String):[],d=o.length;for(var p in t)(e||Mo.call(t,p))&&!(f&&(p=="length"||i&&(p=="offset"||p=="parent")||s&&(p=="buffer"||p=="byteLength"||p=="byteOffset")||W(p,d)))&&o.push(p);return o}var Ue=Bo;function Uo(t,e){return function(r){return t(e(r))}}var Ge=Uo;var Go=Ge(Object.keys,Object),Or=Go;var Wo=Object.prototype,qo=Wo.hasOwnProperty;function Fo(t){if(!le(t))return Or(t);var e=[];for(var r in Object(t))qo.call(t,r)&&r!="constructor"&&e.push(r);return e}var We=Fo;function Ho(t){return T(t)?Ue(t):We(t)}var me=Ho;function $o(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Pr=$o;var Vo=Object.prototype,Ko=Vo.hasOwnProperty;function Jo(t){if(!y(t))return Pr(t);var e=le(t),r=[];for(var a in t)a=="constructor"&&(e||!Ko.call(t,a))||r.push(a);return r}var Dr=Jo;function Qo(t){return T(t)?Ue(t,!0):Dr(t)}var q=Qo;var zo=pe(function(t,e,r,a){Be(e,q(e),t,a)}),he=zo;var Xo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yo=/^\w*$/;function Zo(t,e){if(b(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||G(t)?!0:Yo.test(t)||!Xo.test(t)||e!=null&&t in Object(e)}var ge=Zo;var en=O(Object,"create"),M=en;function tn(){this.__data__=M?M(null):{},this.size=0}var Tr=tn;function rn(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var kr=rn;var an="__lodash_hash_undefined__",sn=Object.prototype,on=sn.hasOwnProperty;function nn(t){var e=this.__data__;if(M){var r=e[t];return r===an?void 0:r}return on.call(e,t)?e[t]:void 0}var Lr=nn;var fn=Object.prototype,dn=fn.hasOwnProperty;function un(t){var e=this.__data__;return M?e[t]!==void 0:dn.call(e,t)}var Cr=un;var pn="__lodash_hash_undefined__";function ln(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=M&&e===void 0?pn:e,this}var jr=ln;function be(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}be.prototype.clear=Tr;be.prototype.delete=kr;be.prototype.get=Lr;be.prototype.has=Cr;be.prototype.set=jr;var ct=be;function cn(){this.__data__=[],this.size=0}var Nr=cn;function mn(t,e){for(var r=t.length;r--;)if(C(t[r][0],e))return r;return-1}var F=mn;var hn=Array.prototype,gn=hn.splice;function bn(t){var e=this.__data__,r=F(e,t);if(r<0)return!1;var a=e.length-1;return r==a?e.pop():gn.call(e,r,1),--this.size,!0}var Rr=bn;function yn(t){var e=this.__data__,r=F(e,t);return r<0?void 0:e[r][1]}var Mr=yn;function xn(t){return F(this.__data__,t)>-1}var Br=xn;function _n(t,e){var r=this.__data__,a=F(r,t);return a<0?(++this.size,r.push([t,e])):r[a][1]=e,this}var Ur=_n;function ye(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}ye.prototype.clear=Nr;ye.prototype.delete=Rr;ye.prototype.get=Mr;ye.prototype.has=Br;ye.prototype.set=Ur;var H=ye;var wn=O(_,"Map"),$=wn;function vn(){this.size=0,this.__data__={hash:new ct,map:new($||H),string:new ct}}var Gr=vn;function En(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var Wr=En;function In(t,e){var r=t.__data__;return Wr(e)?r[typeof e=="string"?"string":"hash"]:r.map}var V=In;function Sn(t){var e=V(this,t).delete(t);return this.size-=e?1:0,e}var qr=Sn;function An(t){return V(this,t).get(t)}var Fr=An;function On(t){return V(this,t).has(t)}var Hr=On;function Pn(t,e){var r=V(this,t),a=r.size;return r.set(t,e),this.size+=r.size==a?0:1,this}var $r=Pn;function xe(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var a=t[e];this.set(a[0],a[1])}}xe.prototype.clear=Gr;xe.prototype.delete=qr;xe.prototype.get=Fr;xe.prototype.has=Hr;xe.prototype.set=$r;var Z=xe;var Dn="Expected a function";function mt(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Dn);var r=function(){var a=arguments,i=e?e.apply(this,a):a[0],s=r.cache;if(s.has(i))return s.get(i);var f=t.apply(this,a);return r.cache=s.set(i,f)||s,f};return r.cache=new(mt.Cache||Z),r}mt.Cache=Z;var Vr=mt;var Tn=500;function kn(t){var e=Vr(t,function(a){return r.size===Tn&&r.clear(),a}),r=e.cache;return e}var Kr=kn;var Ln=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Cn=/\\(\\)?/g,jn=Kr(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Ln,function(r,a,i,s){e.push(i?s.replace(Cn,"$1"):a||r)}),e}),Jr=jn;function Nn(t){return t==null?"":Ft(t)}var Qr=Nn;function Rn(t,e){return b(t)?t:ge(t,e)?[t]:Jr(Qr(t))}var K=Rn;var Mn=1/0;function Bn(t){if(typeof t=="string"||G(t))return t;var e=t+"";return e=="0"&&1/t==-Mn?"-0":e}var j=Bn;function Un(t,e){e=K(e,t);for(var r=0,a=e.length;t!=null&&r<a;)t=t[j(e[r++])];return r&&r==a?t:void 0}var _e=Un;function Gn(t,e,r){var a=t==null?void 0:_e(t,e);return a===void 0?r:a}var n=Gn;function Wn(t,e){for(var r=-1,a=e.length,i=t.length;++r<a;)t[i+r]=e[r];return t}var qe=Wn;var qn=Ge(Object.getPrototypeOf,Object),we=qn;var Fn="[object Object]",Hn=Function.prototype,$n=Object.prototype,zr=Hn.toString,Vn=$n.hasOwnProperty,Kn=zr.call(Object);function Jn(t){if(!E(t)||A(t)!=Fn)return!1;var e=we(t);if(e===null)return!0;var r=Vn.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&zr.call(r)==Kn}var ve=Jn;var Qn="\\ud800-\\udfff",zn="\\u0300-\\u036f",Xn="\\ufe20-\\ufe2f",Yn="\\u20d0-\\u20ff",Zn=zn+Xn+Yn,ef="\\ufe0e\\ufe0f",tf="\\u200d",rf=RegExp("["+tf+Qn+Zn+ef+"]");function af(t){return rf.test(t)}var Xr=af;function sf(){this.__data__=new H,this.size=0}var Yr=sf;function of(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var Zr=of;function nf(t){return this.__data__.get(t)}var ea=nf;function ff(t){return this.__data__.has(t)}var ta=ff;var df=200;function uf(t,e){var r=this.__data__;if(r instanceof H){var a=r.__data__;if(!$||a.length<df-1)return a.push([t,e]),this.size=++r.size,this;r=this.__data__=new Z(a)}return r.set(t,e),this.size=r.size,this}var ra=uf;function Ee(t){var e=this.__data__=new H(t);this.size=e.size}Ee.prototype.clear=Yr;Ee.prototype.delete=Zr;Ee.prototype.get=ea;Ee.prototype.has=ta;Ee.prototype.set=ra;var J=Ee;var oa=typeof exports=="object"&&exports&&!exports.nodeType&&exports,aa=oa&&typeof module=="object"&&module&&!module.nodeType&&module,pf=aa&&aa.exports===oa,ia=pf?_.Buffer:void 0,sa=ia?ia.allocUnsafe:void 0;function lf(t,e){if(e)return t.slice();var r=t.length,a=sa?sa(r):new t.constructor(r);return t.copy(a),a}var na=lf;function cf(t,e){for(var r=-1,a=t==null?0:t.length,i=0,s=[];++r<a;){var f=t[r];e(f,r,t)&&(s[i++]=f)}return s}var fa=cf;function mf(){return[]}var Fe=mf;var hf=Object.prototype,gf=hf.propertyIsEnumerable,da=Object.getOwnPropertySymbols,bf=da?function(t){return t==null?[]:(t=Object(t),fa(da(t),function(e){return gf.call(t,e)}))}:Fe,He=bf;var yf=Object.getOwnPropertySymbols,xf=yf?function(t){for(var e=[];t;)qe(e,He(t)),t=we(t);return e}:Fe,ua=xf;function _f(t,e,r){var a=e(t);return b(t)?a:qe(a,r(t))}var $e=_f;function wf(t){return $e(t,me,He)}var ht=wf;function vf(t){return $e(t,q,ua)}var pa=vf;var Ef=O(_,"DataView"),Ve=Ef;var If=O(_,"Promise"),Ke=If;var Sf=O(_,"Set"),Je=Sf;var la="[object Map]",Af="[object Object]",ca="[object Promise]",ma="[object Set]",ha="[object WeakMap]",ga="[object DataView]",Of=R(Ve),Pf=R($),Df=R(Ke),Tf=R(Je),kf=R(Re),ee=A;(Ve&&ee(new Ve(new ArrayBuffer(1)))!=ga||$&&ee(new $)!=la||Ke&&ee(Ke.resolve())!=ca||Je&&ee(new Je)!=ma||Re&&ee(new Re)!=ha)&&(ee=function(t){var e=A(t),r=e==Af?t.constructor:void 0,a=r?R(r):"";if(a)switch(a){case Of:return ga;case Pf:return la;case Df:return ca;case Tf:return ma;case kf:return ha}return e});var Oe=ee;var Lf=_.Uint8Array,Ie=Lf;function Cf(t){var e=new t.constructor(t.byteLength);return new Ie(e).set(new Ie(t)),e}var ba=Cf;function jf(t,e){var r=e?ba(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var ya=jf;function Nf(t){return typeof t.constructor=="function"&&!le(t)?rr(we(t)):{}}var xa=Nf;var Rf="__lodash_hash_undefined__";function Mf(t){return this.__data__.set(t,Rf),this}var _a=Mf;function Bf(t){return this.__data__.has(t)}var wa=Bf;function Qe(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Z;++e<r;)this.add(t[e])}Qe.prototype.add=Qe.prototype.push=_a;Qe.prototype.has=wa;var va=Qe;function Uf(t,e){for(var r=-1,a=t==null?0:t.length;++r<a;)if(e(t[r],r,t))return!0;return!1}var Ea=Uf;function Gf(t,e){return t.has(e)}var Ia=Gf;var Wf=1,qf=2;function Ff(t,e,r,a,i,s){var f=r&Wf,o=t.length,d=e.length;if(o!=d&&!(f&&d>o))return!1;var p=s.get(t),u=s.get(e);if(p&&u)return p==e&&u==t;var c=-1,m=!0,h=r&qf?new va:void 0;for(s.set(t,e),s.set(e,t);++c<o;){var I=t[c],k=e[c];if(a)var B=f?a(k,I,c,e,t,s):a(I,k,c,t,e,s);if(B!==void 0){if(B)continue;m=!1;break}if(h){if(!Ea(e,function(Q,z){if(!Ia(h,z)&&(I===Q||i(I,Q,r,a,s)))return h.push(z)})){m=!1;break}}else if(!(I===k||i(I,k,r,a,s))){m=!1;break}}return s.delete(t),s.delete(e),m}var ze=Ff;function Hf(t){var e=-1,r=Array(t.size);return t.forEach(function(a,i){r[++e]=[i,a]}),r}var Sa=Hf;function $f(t){var e=-1,r=Array(t.size);return t.forEach(function(a){r[++e]=a}),r}var Aa=$f;var Vf=1,Kf=2,Jf="[object Boolean]",Qf="[object Date]",zf="[object Error]",Xf="[object Map]",Yf="[object Number]",Zf="[object RegExp]",ed="[object Set]",td="[object String]",rd="[object Symbol]",ad="[object ArrayBuffer]",id="[object DataView]",Oa=D?D.prototype:void 0,gt=Oa?Oa.valueOf:void 0;function sd(t,e,r,a,i,s,f){switch(r){case id:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ad:return!(t.byteLength!=e.byteLength||!s(new Ie(t),new Ie(e)));case Jf:case Qf:case Yf:return C(+t,+e);case zf:return t.name==e.name&&t.message==e.message;case Zf:case td:return t==e+"";case Xf:var o=Sa;case ed:var d=a&Vf;if(o||(o=Aa),t.size!=e.size&&!d)return!1;var p=f.get(t);if(p)return p==e;a|=Kf,f.set(t,e);var u=ze(o(t),o(e),a,i,s,f);return f.delete(t),u;case rd:if(gt)return gt.call(t)==gt.call(e)}return!1}var Pa=sd;var od=1,nd=Object.prototype,fd=nd.hasOwnProperty;function dd(t,e,r,a,i,s){var f=r&od,o=ht(t),d=o.length,p=ht(e),u=p.length;if(d!=u&&!f)return!1;for(var c=d;c--;){var m=o[c];if(!(f?m in e:fd.call(e,m)))return!1}var h=s.get(t),I=s.get(e);if(h&&I)return h==e&&I==t;var k=!0;s.set(t,e),s.set(e,t);for(var B=f;++c<d;){m=o[c];var Q=t[m],z=e[m];if(a)var Lt=f?a(z,Q,m,e,t,s):a(Q,z,m,t,e,s);if(!(Lt===void 0?Q===z||i(Q,z,r,a,s):Lt)){k=!1;break}B||(B=m=="constructor")}if(k&&!B){var Te=t.constructor,ke=e.constructor;Te!=ke&&"constructor"in t&&"constructor"in e&&!(typeof Te=="function"&&Te instanceof Te&&typeof ke=="function"&&ke instanceof ke)&&(k=!1)}return s.delete(t),s.delete(e),k}var Da=dd;var ud=1,Ta="[object Arguments]",ka="[object Array]",Xe="[object Object]",pd=Object.prototype,La=pd.hasOwnProperty;function ld(t,e,r,a,i,s){var f=b(t),o=b(e),d=f?ka:Oe(t),p=o?ka:Oe(e);d=d==Ta?Xe:d,p=p==Ta?Xe:p;var u=d==Xe,c=p==Xe,m=d==p;if(m&&Y(t)){if(!Y(e))return!1;f=!0,u=!1}if(m&&!u)return s||(s=new J),f||ce(t)?ze(t,e,r,a,i,s):Pa(t,e,d,r,a,i,s);if(!(r&ud)){var h=u&&La.call(t,"__wrapped__"),I=c&&La.call(e,"__wrapped__");if(h||I){var k=h?t.value():t,B=I?e.value():e;return s||(s=new J),i(k,B,r,a,s)}}return m?(s||(s=new J),Da(t,e,r,a,i,s)):!1}var Ca=ld;function ja(t,e,r,a,i){return t===e?!0:t==null||e==null||!E(t)&&!E(e)?t!==t&&e!==e:Ca(t,e,r,a,ja,i)}var Ye=ja;var cd=1,md=2;function hd(t,e,r,a){var i=r.length,s=i,f=!a;if(t==null)return!s;for(t=Object(t);i--;){var o=r[i];if(f&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++i<s;){o=r[i];var d=o[0],p=t[d],u=o[1];if(f&&o[2]){if(p===void 0&&!(d in t))return!1}else{var c=new J;if(a)var m=a(p,u,d,t,e,c);if(!(m===void 0?Ye(u,p,cd|md,a,c):m))return!1}}return!0}var Na=hd;function gd(t){return t===t&&!y(t)}var Ze=gd;function bd(t){for(var e=me(t),r=e.length;r--;){var a=e[r],i=t[a];e[r]=[a,i,Ze(i)]}return e}var Ra=bd;function yd(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var et=yd;function xd(t){var e=Ra(t);return e.length==1&&e[0][2]?et(e[0][0],e[0][1]):function(r){return r===t||Na(r,t,e)}}var Ma=xd;function _d(t,e){return t!=null&&e in Object(t)}var Ba=_d;function wd(t,e,r){e=K(e,t);for(var a=-1,i=e.length,s=!1;++a<i;){var f=j(e[a]);if(!(s=t!=null&&r(t,f)))break;t=t[f]}return s||++a!=i?s:(i=t==null?0:t.length,!!i&&ue(i)&&W(f,i)&&(b(t)||X(t)))}var Ua=wd;function vd(t,e){return t!=null&&Ua(t,e,Ba)}var Ga=vd;var Ed=1,Id=2;function Sd(t,e){return ge(t)&&Ze(e)?et(j(t),e):function(r){var a=n(r,t);return a===void 0&&a===e?Ga(r,t):Ye(e,a,Ed|Id)}}var Wa=Sd;function Ad(t){return function(e){return e?.[t]}}var tt=Ad;function Od(t){return function(e){return _e(e,t)}}var qa=Od;function Pd(t){return ge(t)?tt(j(t)):qa(t)}var Fa=Pd;function Dd(t){return typeof t=="function"?t:t==null?oe:typeof t=="object"?b(t)?Wa(t[0],t[1]):Ma(t):Fa(t)}var rt=Dd;function Td(t){return function(e,r,a){for(var i=-1,s=Object(e),f=a(e),o=f.length;o--;){var d=f[t?o:++i];if(r(s[d],d,s)===!1)break}return e}}var Ha=Td;var kd=Ha(),$a=kd;function Ld(t,e,r){(r!==void 0&&!C(t[e],r)||r===void 0&&!(e in t))&&de(t,e,r)}var Pe=Ld;function Cd(t){return E(t)&&T(t)}var Va=Cd;function jd(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var De=jd;function Nd(t){return Be(t,q(t))}var Ka=Nd;function Rd(t,e,r,a,i,s,f){var o=De(t,r),d=De(e,r),p=f.get(d);if(p){Pe(t,r,p);return}var u=s?s(o,d,r+"",t,e,f):void 0,c=u===void 0;if(c){var m=b(d),h=!m&&Y(d),I=!m&&!h&&ce(d);u=d,m||h||I?b(o)?u=o:Va(o)?u=ir(o):h?(c=!1,u=na(d,!0)):I?(c=!1,u=ya(d,!0)):u=[]:ve(d)||X(d)?(u=o,X(o)?u=Ka(o):(!y(o)||ne(o))&&(u=xa(d))):c=!1}c&&(f.set(d,u),i(u,d,a,s,f),f.delete(d)),Pe(t,r,u)}var Ja=Rd;function Qa(t,e,r,a,i){t!==e&&$a(e,function(s,f){if(i||(i=new J),y(s))Ja(t,e,f,r,Qa,a,i);else{var o=a?a(De(t,f),s,f+"",t,e,i):void 0;o===void 0&&(o=s),Pe(t,f,o)}},q)}var at=Qa;var Md=pe(function(t,e,r,a){at(t,e,r,a)}),it=Md;var Bd="[object String]";function Ud(t){return typeof t=="string"||!b(t)&&E(t)&&A(t)==Bd}var st=Ud;function Gd(t,e){return se(e,function(r){return t[r]})}var za=Gd;function Wd(t){return t==null?[]:za(t,me(t))}var Xa=Wd;var qd=Math.max;function Fd(t,e,r,a){t=T(t)?t:Xa(t),r=r&&!a?zt(r):0;var i=t.length;return r<0&&(r=qd(i+r,0)),st(t)?r<=i&&t.indexOf(e,r)>-1:!!i&&lr(t,e,r)>-1}var bt=Fd;function Hd(t){return t==null}var te=Hd;var $d=pe(function(t,e,r){at(t,e,r)}),l=$d;var Vd="Expected a function";function Kd(t){if(typeof t!="function")throw new TypeError(Vd);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}var Ya=Kd;function Jd(t,e,r,a){if(!y(t))return t;e=K(e,t);for(var i=-1,s=e.length,f=s-1,o=t;o!=null&&++i<s;){var d=j(e[i]),p=r;if(d==="__proto__"||d==="constructor"||d==="prototype")return t;if(i!=f){var u=o[d];p=a?a(u,d,o):void 0,p===void 0&&(p=y(u)?u:W(e[i+1])?[]:{})}Me(o,d,p),o=o[d]}return t}var ot=Jd;function Qd(t,e,r){for(var a=-1,i=e.length,s={};++a<i;){var f=e[a],o=_e(t,f);r(o,f)&&ot(s,K(f,t),o)}return s}var Za=Qd;function zd(t,e){if(t==null)return{};var r=se(pa(t),function(a){return[a]});return e=rt(e),Za(t,r,function(a,i){return e(a,i[0])})}var ei=zd;function Xd(t,e){return ei(t,Ya(rt(e)))}var re=Xd;var Yd=tt("length"),ti=Yd;var ai="\\ud800-\\udfff",Zd="\\u0300-\\u036f",eu="\\ufe20-\\ufe2f",tu="\\u20d0-\\u20ff",ru=Zd+eu+tu,au="\\ufe0e\\ufe0f",iu="["+ai+"]",yt="["+ru+"]",xt="\\ud83c[\\udffb-\\udfff]",su="(?:"+yt+"|"+xt+")",ii="[^"+ai+"]",si="(?:\\ud83c[\\udde6-\\uddff]){2}",oi="[\\ud800-\\udbff][\\udc00-\\udfff]",ou="\\u200d",ni=su+"?",fi="["+au+"]?",nu="(?:"+ou+"(?:"+[ii,si,oi].join("|")+")"+fi+ni+")*",fu=fi+ni+nu,du="(?:"+[ii+yt+"?",yt,si,oi,iu].join("|")+")",ri=RegExp(xt+"(?="+xt+")|"+du+fu,"g");function uu(t){for(var e=ri.lastIndex=0;ri.test(t);)++e;return e}var di=uu;function pu(t){return Xr(t)?di(t):ti(t)}var ui=pu;function lu(t,e,r){return t==null?t:ot(t,e,r)}var w=lu;var cu="[object Map]",mu="[object Set]";function hu(t){if(t==null)return 0;if(T(t))return st(t)?ui(t):t.length;var e=Oe(t);return e==cu||e==mu?t.size:We(t).length}var _t=hu;var wt=class{constructor(){let e=P();this.appId=e&&v("appId",e.src),this._id="App-Log",l(this,x),this.debugHeader=`Data Layer ${this._id} Plugin`,this.debugParams=[],Le(this.appId)&&(this.supportsBeacon=n(window,"navigator.sendBeacon"),this._version="3.20.3",this.bindListeners())}bindListeners(){document.addEventListener("c-tracking-trigger",this.executeTrackingCall.bind(this),!1),document.addEventListener("c-tracking-load-defaults",this.setDefaults.bind(this),!1)}setDefaults(e){e.detail.plugins.push({name:this._id,version:this._version,appId:this.appId,errorDetected:this.checkErrors()})}checkErrors(){return(this.pluginError||typeof XMLHttpRequest!="function")&&(this.pluginError=!0),this.pluginError}sendAjax(e,r,a){if(r&&this.supportsBeacon)navigator.sendBeacon("https://dss-dl-prod.aws-origin.xfinity.com/prod/event/",JSON.stringify(a));else{var i=new XMLHttpRequest;i._fromDL=!0,i.onreadystatechange=i.ontimeout=function(s){s.target.readyState===XMLHttpRequest.DONE&&(this.debugParams=[e,"done"],this.debug(i.status===200?"SUCCESS":"FAILED",', Type: "',s.type,'", Request Obj: ',s.target))}.bind(this),i.open("PUT","https://dss-dl-prod.aws-origin.xfinity.com/prod/event/",!r),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify(a))}this.debugParams=[e,"send"],this.debug('Payload: "',a,'"')}sendRequest(e,r,a){var i={method:r,Data:JSON.stringify(e)};this.sendAjax(r,a,i)}executeTrackingCall(e){try{var r=l({},e.detail.data.eventInfo),a,i=!1,s=n(r,"_sendWithBeacon",!1),f=n(r,"eventMethod","")||"send-Event";switch(delete r._sendWithBeacon,f){case"c-tracking-ajax":n(r,"performance.ajax")&&(r.ajax=n(r,"performance.ajax[0]"),delete r.performance.ajax);case"client-exception":case"app-log":i=!0;break;default:break}i&&!this.pluginError&&(r.skipEventKeys=r.skipEventKeys||[],l(r,["schemaVersion","version","subSchemas","siteInfo.visitorID","siteInfo.sessionID","siteInfo.ctpSessionID","shared.visitorID","shared.sessionID","browserInfo.location","browserInfo.referrer","browserInfo.navigator.userAgent","page.pageInfo.pageName","page.codebase.name","user[0].segment","user[0].profile[0].profileInfo.customerType","user[0].profile[0].profileInfo.custGUID","user[0].profile[0].profileInfo.authenticationType","user[0].profile[0].profileInfo.authGUID"].concat(n(window,"digitalData.config.plugins.appLog.eventFields",[])).reduce((o,d)=>{if(typeof d=="string"&&d.startsWith("func:")){let u=n(window,d.substr(d.indexOf(":")+1),function(){})();if(typeof u=="object"&&u!==null)try{l(o,u)}catch(c){this.debug(`Exception occurred executing '${d}' callback. Error was '${c.message}'`)}else this.debug(`Invalid value returned from '${d}' callback. Value was '${u}'. Only Objects are allowed.`)}else!r.skipEventKeys.indexOf(d)!==-1&&w(o,d,n(window.digitalData,d,void 0));return o},{eventMethod:f})),delete r.skipEventKeys,n(r,"user[0]")&&(r.user=n(r,"user[0]"),n(r,"user.profile[0]")&&(r.user.profile=n(r,"user.profile[0]"))),a=r,this.sendRequest(a,f,s))}catch(o){this.debug("EXCEPTION:",o,this.pluginError?"APP-LOG NOT AVAILABLE!":"")}}},Hx=new wt;var vt=class{constructor(){let e=P();this.appId=e&&v("appId",e.src)||"",l(this,x),this._id="techTags",this.debugHeader=`Data Layer ${this._id} Plugin`,this.debugParams=[],this.preloadedApps=[],this._version="3.20.3",this.bindListeners()}bindListeners(){document.addEventListener("c-tracking-trigger",this.dlUpdated.bind(this),!1),document.addEventListener("c-tracking-load-defaults",this.setDefaults.bind(this),!1)}setDefaults(e){e.detail.plugins.push({name:this._id,version:this._version,appId:this.appId})}shouldExec(e){let r=(n(e,"detail.page.codebase.name")||n(window.digitalData,"page.codebase.name")||"").toLowerCase(),a=n(e,`detail.config.plugins.${this._id}.active`)||n(window.digitalData,`config.plugins.${this._id}.active`),i=["consent-ui","df buyflow","df checkout","df learn","df my plan","digital","modular","orderlab","resi_buyflow","resi_buyflow_agent","resi_buyflow_approval","resi_shop","resi_shop_2","resi_shop_agent","resi_subscription_management","resi_xm_buyflow_2","resi_xm_shop_2","xds","xoe digital repo","xoe portal","xoe-customer-disconnect","xoe-device-management"];return a||i.indexOf(r)!==-1||i.indexOf(this.appId.toLowerCase())!==-1?this.tagsActivated=!0:(n(window.digitalData,"performance")&&(this.tagsActivated=!0),!1)}appDKey(){var e;return e={resi_subscription_management:"AD-AAB-ABK-VWE",resi_xm_buyflow_2:"AD-AAB-AAJ-NTY",resi_xm_shop_2:"AD-AAB-AAJ-NTY",default:"AD-AAB-AAB-RTC"},e[this.appId.toLowerCase()]||e.default}injectAppD(e){if(!window.ADRUM&&!window["adrum-config"]){window["adrum-start-time"]=new Date().getTime();let i=n(e,`detail.config.plugins.${this._id}.isAngularApp`)||n(window.digitalData,`config.plugins.${this._id}.isAngularApp`);(function(s){s.appKey=this.appDKey(),s.adrumExtUrlHttp="http://assets.xfinity.com/assets/dotcom/adrum",s.adrumExtUrlHttps="https://assets.xfinity.com/assets/dotcom/adrum",s.beaconUrlHttp="http://col.eum-appdynamics.com",s.beaconUrlHttps="https://col.eum-appdynamics.com",s.xd={enable:!1},s.longStackTrace=!1,s.spa={spa2:!0},i===!0&&(s.isZonePromise=!0,s.angular=!0)}).call(this,window["adrum-config"]||(window["adrum-config"]={}));var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src="//assets.xfinity.com/assets/dotcom/adrum/adrum22603859.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(r,a)}}dlUpdated(e){this.tagsActivated||this.shouldExec(e)&&this.injectAppD(e),e?.detail?.type==="c-tracking-init-complete"&&this.checkPreload(e).forEach(this.executePreLoad.bind(this))}checkPreload(e){let r=n(e,`detail.config.plugins.${this._id}.preload`)||n(window.digitalData,`config.plugins.${this._id}.preload`)||[];return["resi_shop","resi_shop_2","resi_shop_agent"].indexOf(this.appId.toLowerCase())!==-1&&r.push({appID:"resi_buyflow",useDC:!0,resourceURL:"/buy/includes/dist/manifest.json"}),r}async processResourceJSON(e,r){this.debug("Process Resource:",e,r);let a=await r.json();this.debug("Process Resource Content:",a),Object.keys(a).forEach(i=>{let s=document.createElement("link");s.rel="prefetch",e&&e.endsWith("/")&&a[i].startsWith("/")&&(e=e.substr(0,e.length-1)),s.href=(e||"")+a[i];let f="",o=U(s.href).pathname?.match(/(\.\w+$)/gim);if(o&&o.length>0)switch(o[0].toLowerCase()){case".js":f="script";break;case".css":f="style";break}s.as=f,document.head.appendChild(s),this.debug("Link Processed:",i,s)})}executePreLoad(e){if(this.preloadedApps.indexOf(e.appID.toLowerCase())!==-1){this.debug("App already pre-loaded:",e);return}this.preloadedApps.push(e.appID.toLowerCase());let r=e.resourceURL,a={};if(e.useDC){let i=document.cookie.split(";").map(s=>s.split("=")[0].trim());if(a=[{id:"wc",path:"wcdc"},{id:"po",path:"pdc"},{id:"ch",path:"ch2"}].map(s=>({name:`www-prd_${s.id}`,url:`https://cdn.${s.path}.comcast.com`})).find(s=>i.indexOf(s.name)!==-1),this.debug("DC:",e,a),!a){document.body.dispatchEvent(new CustomEvent("c-tracking-log-error",{detail:new Error(`Data Center cookie not found for ${e.appID}`),bubbles:!0})),this.debug("Data Center Cookie not found");return}r=a.url+r}this.debug("Full Url: ",r);try{fetch(r).then(this.processResourceJSON.bind(this,a.url)).catch(i=>{document.body.dispatchEvent(new CustomEvent("c-tracking-log-error",{detail:i,bubbles:!0}))})}catch{}}},Qx=new vt;var Et=class{constructor(){this.currentScript=P(),this.appId=this.currentScript&&v("appId",this.currentScript.src)||"",l(this,x);let r=ie("disableDlPixel",(a,i)=>a==="true"?!0:i);this._pixelDisabled=r(window.location.href),this._id="xfinity-session",this.debugHeader=`Data Layer ${this._id} Plugin`,this.debugParams=[],this.polarisData=S.init("polaris",{}),this.appId.startsWith("resi_xm")&&this.polarisData.custGUID&&setTimeout(this.checkOptOut.bind(this),0),this.xmTempOptOut(),this.updatePolarisInfo(),this.bindListeners(),this.debug("initialized"),this.initInfo()}xmTempOptOut(){if(this.appId.startsWith("resi_xm")){if(!n(window,"digitalData.performance.pageView")){this.debug("OptOut Waiting for XM page view"),setTimeout(this.xmTempOptOut.bind(this),200);return}this.polarisData.custGUID=n(window,"digitalData.users[0].profile[0].profileInfo.custGUID",void 0),S.polaris=this.polarisData,S.save(),this.debug("Data update from XM",this.polarisData),setTimeout(this.checkOptOut.bind(this),0)}}updateOptOut(e){if(this.optOutTriggered){this.debug("OptOut already sent");return}if(!document.body){this.debug("OptOut Waiting for body"),setTimeout(this.updateOptOut.bind(this,e),0);return}w(this,"polarisData.optOut",e);let r=new CustomEvent("c-tracking-log-dom",{detail:{eventMethod:"tracking-dispatch-optout",...this.polarisData},bubbles:!0});this.debug("sendOptOut: ",r),document.body.dispatchEvent(r),this.optOutTriggered=!0}optOutResponseHandler(e){let r=e.target;if(r.status>=200&&r.status<300){let a=null,i=!1;try{a=JSON.parse(r.responseText),w(this,"polarisData.optOut",a)}catch{i=!0}this.triggerOptOutEvent&&this.updateOptOut(a),i||(S.optOut=a,S.optOutDate=Date.now(),S.save())}}triggerRequest(e){this.optOutRequest||(this.optOutRequest=new XMLHttpRequest,this.optOutRequest.addEventListener("load",e),this.optOutRequest.open("GET",`https://api.pps.sys.comcast.net/privacyPreferences/identityGuid/${this.polarisData.custGUID}/all`),this.optOutRequest.send())}clearOptOut(){this.polarisData.optOut=S.optOut={},S.optOutDate=null,S.polaris=this.polarisData,S.save()}checkOptOut(){if(!this.polarisData.custGUID){this.appId.startsWith("resi_xm")&&this.clearOptOut(),this.updateOptOut({});return}let e=n(S,"optOut",null),r=new Date(n(S,"optOutDate","0")),a=new Date;a.setDate(a.getDate()-7),a>r?(this.triggerOptOutEvent=!0,this.triggerRequest(this.optOutResponseHandler.bind(this))):e&&(this.updateOptOut(e),a=new Date,a.setDate(a.getDate()-1),a>r&&(this.triggerOptOutEvent=!1,this.triggerRequest(this.optOutResponseHandler.bind(this))))}updatePolarisInfo(e){if(n(e,"detail.type")||document.querySelector("xc-header")){let r=n(e,"detail.type")==="user"&&n(e,"detail.response")||n(document.querySelector("xc-header"),"data.polaris.user");r&&((r.hasOwnProperty("authGuid")||r.hasOwnProperty("customerGuid")||n(r,"isAuthenticated")==="false")&&(this.polarisData.authGUID=r.authGuid,this.polarisData.custGUID=r.customerGuid),r.hasOwnProperty("accountStatus")&&w(this.polarisData,"status.account",r.accountStatus),r.services&&w(this.polarisData,"status.services",{cdv:r.services.cdvStatus,homeSecurity:r.services.homeSecurityStatus,hsd:r.services.hsdStatus,mobile:r.services.mobileStatus,video:r.services.videoStatus}),this.polarisData.type=n(r,"role","").toString().toLowerCase().trim(),this.polarisData.linkedCount=Object.keys(n(r,"linkedAccounts",{})).length,S.polaris=this.polarisData,S.save(),document.dispatchEvent(new CustomEvent("c-tracking-log-update",{detail:this.populatePolaris({}),bubbles:!0})),this.polarisNotify())}this.appId.startsWith("resi_xm")||setTimeout(this.checkOptOut.bind(this),0)}polarisNotify(){setTimeout(()=>{let e=new CustomEvent("c-tracking-log-dom",{detail:{eventMethod:"tracking-dispatch-polaris",...this.polarisData},bubbles:!0});this.debug("update polaris: ",e),document.body.dispatchEvent(e)},0)}initInfo(){if(!this.checkErrors()){var e=JSON.parse(localStorage.getItem(this._id)||"{}");e.sessionID=e.sessionID||this.getCookieValue("SC")["RC.USID"],e.visitorID=e.visitorID||this.getCookieValue("PSC").UCID,this.lastRun=this.lastRun||e.lastRun,e.sessionID&&e.visitorID&&this.setInfo(e)}}bindListeners(){this.checkErrors()||(window.addEventListener("polaris-data-changed",this.updatePolarisInfo.bind(this),!1),document.addEventListener("c-tracking-load-defaults",this.populateDataLayer.bind(this),!1),document.addEventListener("c-tracking-log-page",this.updateInfo.bind(this),!1))}getCookieValue(e){var r=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)"),a={};return(r?r.pop():"").replace(/([^=&]+)=([^&]*)/g,function(i,s,f){a[decodeURIComponent(s)]=decodeURIComponent(f)}),a}populateDataLayer(e){e.detail.plugins.push({name:this._id,version:"3.20.3",errorDetected:this.checkErrors()}),this.setData(e.detail),this.updateInfo()}setData(e){return this.info&&(e.shared=e.shared||{},e.shared.sessionID=e.shared.sessionID||this.info.sessionID,e.shared.visitorID=e.shared.visitorID||this.info.visitorID),this.populatePolaris(e),e}populatePolaris(e){return this.polarisData&&Object.keys(this.polarisData).forEach(r=>{let a=`user[0].profile[0].profileInfo.${r}`;n(e,a)||w(e,a,this.polarisData[r])}),e}setInfo(e){this.info=e||{sessionID:this.getCookieValue("SC")["RC.USID"]||"",visitorID:this.getCookieValue("PSC").UCID||""},localStorage.setItem(this._id,JSON.stringify(l({lastRun:this.lastRun},this.info))),this.debug("Info Stored",this.info)}makeImageRequest(e){if(!document.body){this.debug("Session Waiting for body"),setTimeout(this.makeImageRequest.bind(this,e),0);return}let r=!1,a;this.img=this.img||document.createElement("img"),this.img.setAttribute("alt",""),this.img.src="https://www.xfinity.com/-/media/5BF28DC6EBA54E929173CC7B0D9B6E69?ts="+Date.now(),this.img.style.display="none",a=setTimeout(()=>{this.debug("Session Image Request Timeout"),!r&&e(),r=!0},5e3),this.img.onerror=i=>{clearTimeout(a),this.requestComplete=!0,this.imgFailure=!0,this.debug("Session Image Request Failed",i),!r&&e(),r=!0},this.img.onload=i=>{clearTimeout(a),this.requestComplete=!0,this.debug("Session Image Request Success",i),this.setInfo(),!r&&e(),r=!0},document.body.appendChild(this.img)}updateInfo(){if(this.updateActive){this.debug("Session ABORT based on active");return}if(this.lastRun+60*1e3*5>Date.now())return;this.lastRun=Date.now(),this.updateActive=!0,this.debug("Update Info Initiated, Current Data:",this.info);let e=!1;this.info||(this.debug("Session Data Layer Wait"),e=!0,document.dispatchEvent(new CustomEvent("c-tracking-wait",{bubbles:!0})));let r=()=>{document.dispatchEvent(new CustomEvent("c-tracking-log-update",{detail:this.setData({}),bubbles:!0})),this.updateActive=!1};this._pixelDisabled?(this.setInfo(),e?r():this.updateActive=!1):this.makeImageRequest(this.info?()=>{this.updateActive=!1}:r)}checkErrors(){return(this.pluginError||!ae.localStorage||!/\.xfinity\.com$/i.test(window.location.hostname))&&(this.pluginError=!0),this.pluginError}},Zx=new Et;var It=class{constructor(){l(this,x),this._id="PERSIST",this.debugHeader=`Data Layer ${this._id} Plugin`,this.debugParams=[],this._version="3.20.3",this.bindListeners()}bindListeners(){document.addEventListener("c-tracking-trigger",this.dlUpdated.bind(this),!1),document.addEventListener("c-tracking-load-defaults",this.setDefaults.bind(this),!1)}setDefaults(e){e.detail.plugins.push({name:this._id,version:this._version,description:"Enable persistence of data layer properties across page views",errorDetected:this.checkErrors()})}checkErrors(){return(this.pluginError||!ae.localStorage||!ae.sessionStorage)&&(this.pluginError=!0),this.pluginError}populatedSharedData(e){let r=e.getItem("dl_Cache"),a;try{r=JSON.parse(r)}catch{r=null}r&&l(window.digitalData,[].concat(n(window.digitalData,`config.plugins.persistence.${e===window.localStorage?"browser":"session"}`,[])).reduce((i,s)=>(w(i,s,(a=n(window.digitalData,s,void 0))===void 0?n(r,s,void 0):a),i),{}))}storeSharedData(e){let r={};l(r,[].concat(n(window.digitalData,`config.plugins.persistence.${e===window.localStorage?"browser":"session"}`,[])).reduce((a,i)=>(w(a,i,n(window.digitalData,i,void 0)),a),{})),e.setItem("dl_Cache",JSON.stringify(r))}dlUpdated(e){n(e,"detail.type","")==="page"&&(this.populatedSharedData(window.localStorage),this.populatedSharedData(window.sessionStorage),this.storeSharedData(window.localStorage),this.storeSharedData(window.sessionStorage))}},a_=new It;var St=class{constructor(){let e=P();this.appId=e&&v("appId",e.src),l(this,x),this._id="AWS",this.supportsBeacon=n(window,"navigator.sendBeacon"),this.debugHeader=`Data Layer ${this._id} Plugin`,this.debugParams=[],this._version="3.20.3",this._ignoredEvents=[],this.bindListeners()}bindListeners(){document.addEventListener("c-tracking-trigger",this.executeTrackingCall.bind(this),!1),document.addEventListener("c-tracking-load-defaults",this.setDefaults.bind(this),!1)}setDefaults(e){this._ignoredEvents=n(window.digitalData,"config.plugins.aws.ignoredEvents",[]),e.detail.plugins.push({name:this._id,version:this._version,description:"Pass Data-Layer information to aws end point",errorDetected:this.checkErrors()})}checkErrors(){return(this.pluginError||typeof XMLHttpRequest!="function")&&(this.pluginError=!0),this.pluginError}sendAjax(e,r,a){if(r&&this.supportsBeacon)navigator.sendBeacon("https://dl.cws.xfinity.com/event/",JSON.stringify(a));else{var i=new XMLHttpRequest;i._fromDL=!0,i.onreadystatechange=i.ontimeout=function(s){s.target.readyState===XMLHttpRequest.DONE&&(this.debugParams=[e,"done"],this.debug(i.status===200?"SUCCESS":"FAILED",', Type: "',s.type,'", Request Obj: ',s.target))}.bind(this),i.open("PUT","https://dl.cws.xfinity.com/event/",!r),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify(a))}this.debugParams=[e,"send"],this.debug('Payload: "',a,'"')}sendRequest(e,r,a){var i={method:r,Data:JSON.stringify(e)};this.sendAjax(r,a,i)}executeTrackingCall(e){try{var r=l({},e.detail.data.eventInfo),a,i=n(e,"detail.type",""),s=!0,f=n(r,"_sendWithBeacon",!1),o=n(r,"eventMethod","")||"send-Event",d=!1;switch(delete r._sendWithBeacon,i){case"ajax":s=Ce(this.appId),d=!0,n(r,"performance.ajax")&&(r.ajax=n(r,"performance.ajax[0]"),delete r.performance.ajax);break;case"page":o="PageLoadEvent";break;case"c-tracking-init-start":o="PageInit-Start";break;case"c-tracking-init-complete":o="PageInit-Complete";break;default:i.startsWith("c-tracking-init-")&&(s=!1),d=!0;break}this._ignoredEvents.includes(o)&&(s=!1,this.debug("EVENT IGNORED",o)),s&&!this.pluginError&&(d?(r.skipEventKeys=r.skipEventKeys||[],l(r,["schemaVersion","version","subSchemas","siteInfo.visitorID","siteInfo.sessionID","siteInfo.ctpSessionID","shared.visitorID","shared.sessionID","browserInfo.location","browserInfo.referrer","browserInfo.navigator.userAgent","page.pageInfo.pageName","page.codebase.name","user[0].segment","user[0].profile[0].profileInfo.customerType","user[0].profile[0].profileInfo.custGUID","user[0].profile[0].profileInfo.authenticationType","user[0].profile[0].profileInfo.authGUID"].concat(n(window,"digitalData.config.plugins.aws.eventFields",[])).reduce((p,u)=>{if(typeof u=="string"&&u.startsWith("func:")){let m=n(window,u.substr(u.indexOf(":")+1),function(){})();if(typeof m=="object"&&m!==null)try{l(p,m)}catch(h){this.debug(`Exception occurred executing '${u}' callback. Error was '${h.message}'`)}else this.debug(`Invalid value returned from '${u}' callback. Value was '${m}'. Only Objects are allowed.`)}else!r.skipEventKeys.indexOf(u)!==-1&&w(p,u,n(window.digitalData,u,void 0));return p},{eventMethod:o})),delete r.skipEventKeys,a=r):a=l({},window.digitalData,{eventMethod:o}),this.sendRequest(a,o,f))}catch(p){this.debug("EXCEPTION:",p,this.pluginError?"AWS NOT AVAILABLE!":"")}}},n_=new St;var At=class{constructor(){this.initStart=n(window,"performance.timing",{}).requestStart||Date.now(),this.currentScript=P(),l(this,x),this._id="LAUNCH",this._version="3.20.3",this._status="INIT",this.debugHeader=`Data Layer ${this._id} Plugin`,this.debugParams=[],this._initQueue=[],this.initConfig(),document.addEventListener("c-tracking-load-defaults",this.setDefaults.bind(this),!1),document.addEventListener("c-tracking-dispatch-targetUpdate",e=>{let r=e.detail,a=!1;delete r.eventMethod,Object.keys(this.config).forEach(i=>{r.hasOwnProperty(i)&&(this.config[i]=L.lConfig[i]=r[i],a=!0)}),a&&this.processConfig(r)},!1),this._exec=this.executeTrackingCall.bind(this),this.loadLaunch()&&(this.toggleFlicker(!0),document.addEventListener("c-tracking-trigger",this._exec,!1))}initConfig(){this.config=L.init("lConfig",{initTimeout:2500,spaTimeout:1e3,noTargetDelay:!0,flickerDisable:!1}),this.config.notifyTimeout=this.config.notifyTimeout||1e3,Object.keys(this.config).forEach(e=>{let r=v(`launch_${e}`,window.location.href);if(r){switch(typeof this.config[e]){case"number":r=Number(r);break;case"boolean":r=r==="true";break}this.config[e]=L.lConfig[e]=r,L.save()}})}updateStyle(e){if(this.styleBlock||(this.styleBlock=document.createElement("style")),e){if(this.styleBlock.parentNode){let r=250;this.styleBlock.innerHTML=`body { opacity: 1; animation: ${r}ms fadein; } @keyframes fadein { from { opacity: 0; } to   { opacity: 1; } }`,setTimeout(()=>{this.styleBlock.parentNode.removeChild(this.styleBlock)},r)}}else this.styleBlock.innerHTML="body { opacity: 0; }",this.styleBlock.parentNode!==this.currentScript.parentNode&&this.currentScript.parentNode.insertBefore(this.styleBlock,this.currentScript)}toggleFlicker(e,r){if(!L.lConfig.flickerDisable&&e){let a,{initTimeout:i,spaTimeout:s}=this.config;a=r?s:i,this.flickerTimer&&clearTimeout(this.flickerTimer);let f=Date.now()-this.initStart;a=a-f,a=a<0?0:a,this.flickerTimer=setTimeout(this.toggleFlicker.bind(this,!1,r),a),this.flickerActive=!0,this.flickerIsSpa=r,this.updateStyle()}else this.flickerActive&&(this.flickerActive=!1,this.flickerTimer=null,this.updateStyle(!0))}setStatus(e){return function(a){return this._status=e,this.debugParams=[e],this.debug(a),document.removeEventListener("c-tracking-trigger",this._exec),!1}.bind(this)}loadLaunch(){let e=this.setStatus("ERROR"),r=this.setStatus("DISABLED"),a=(u,c)=>u!=null?u==="true":c,i=ie("disableScripts",a),s=ie("debugLaunch",a);if(i(window.location.href))return r("Disable scripts enabled!");let f=this.currentScript&&v("appId",this.currentScript.src),o=this.currentScript&&v("workflowID",this.currentScript.src);if(typeof window._satellite<"u"){if(typeof window._satellite.buildInfo<"u")return this.debug("Launch already detected, proceeding with activation through load success."),this.launchLoaded(),!0;if(typeof window._satellite.configurationSettings<"u")return e('Instance of "_satellite" already found! Aborting Launch initialization.')}if(s(window.location.href))return this.debug("Debug launch enabled, launch not yet be loaded."),!0;if(!o&&!f)return e("Application identifier not found!");let d,p;return p={test:"https://assets.adobedtm.com/331fbea29f79/f0f7bfe56a6a/launch-400f7622ecac.min.js",login:"https://assets.adobedtm.com/331fbea29f79/fdd77923e2da/launch-46f715e51bac.min.js",resi_stream:"https://assets.adobedtm.com/launch-ENcd3e2a27442a49a1ad80b135b0864a86.min.js",resi_shop:"https://assets.adobedtm.com/331fbea29f79/8f42148123cf/launch-19300f6b92a2.min.js",resi_shop_agent:"https://assets.adobedtm.com/331fbea29f79/69ccdb5b9b50/launch-b9e16cebbe07.min.js",resi_shop_ancillary:"https://assets.adobedtm.com/331fbea29f79/5d27143e4c5d/launch-e78575acc1e1.min.js",resi_shop_2:"https://assets.adobedtm.com/331fbea29f79/a5b25a446515/launch-e80baf9c0255.min.js",resi_store:"https://assets.adobedtm.com/launch-ENa66d966c74de48afb591eea95568fc0e.min.js",resi_buyflow:"https://assets.adobedtm.com/331fbea29f79/8ae378df34a6/launch-cc1b3681205e.min.js",resi_subscription_management:"https://assets.adobedtm.com/331fbea29f79/18d1c60239db/launch-90557250d9d7.min.js",resi_buyflow_agent:"https://assets.adobedtm.com/331fbea29f79/832a0e1dcba6/launch-2746c9ab6080.min.js",resi_buyflow_approval:"https://assets.adobedtm.com/331fbea29f79/7d5350f4b8ad/launch-027479a776a5.min.js",resi_myaccount:"https://assets.adobedtm.com/331fbea29f79/de1fe8df812b/launch-cbf8c01aa601.min.js",resi_myaccount_2:"https://assets.adobedtm.com/331fbea29f79/5846c179fe9d/launch-73fa91d0176e.min.js",resi_support:"https://assets.adobedtm.com/331fbea29f79/c45f53b40264/launch-27c33353fd63.min.js",resi_support_2:"https://assets.adobedtm.com/331fbea29f79/c45f53b40264/launch-27c33353fd63.min.js",resi_support_fe:"https://assets.adobedtm.com/331fbea29f79/801bfc652c34/launch-ba8a20ec41a6.min.js",resi_xm:"https://assets.adobedtm.com/launch-ENbc981f2f364f42909fb426dbc3fec810.min.js",resi_xm_buyflow:"https://assets.adobedtm.com/331fbea29f79/f5d2107f9dfd/launch-6cc47641d08f.min.js",resi_xm_buyflow_2:"https://assets.adobedtm.com/331fbea29f79/a1677ef86d87/launch-d7f43fab9698.min.js",resi_xm_convergence:"https://assets.adobedtm.com/331fbea29f79/136641d0e8ce/launch-3650cb752f75.min.js",resi_xm_myaccount:"https://assets.adobedtm.com/331fbea29f79/c0a78d794175/launch-7dc11f06b777.min.js",resi_xm_shop:"https://assets.adobedtm.com/331fbea29f79/f88e7fa02c6b/launch-29d494ec28f2.min.js",resi_xm_shop_2:"https://assets.adobedtm.com/331fbea29f79/bbf7e1c8104a/launch-e5e8890c27e7.min.js",resi_myxfn:"https://assets.adobedtm.com/331fbea29f79/f0c0e1a9ad11/launch-29c49a6863fd.min.js",resi_cpp:"https://assets.adobedtm.com/331fbea29f79/b89b840626b5/launch-dfc187a05ec1.min.js",resi_cpp_2:"https://assets.adobedtm.com/331fbea29f79/9e0fce69766d/launch-f672265a5f2f.min.js",resi_xumo:"https://assets.adobedtm.com/331fbea29f79/e8a7f3d33ed6/launch-b48308a3be5f.min.js",resi_prepaid:"https://assets.adobedtm.com/331fbea29f79/e5b825f47ce6/launch-18bdbdf8eca5.min.js",resi_global:"https://assets.adobedtm.com/331fbea29f79/e5b825f47ce6/launch-18bdbdf8eca5.min.js",idm:"https://assets.adobedtm.com/331fbea29f79/3ac6e7f13fd8/launch-995a63aed64a.min.js",busn_eccc:"https://assets.adobedtm.com/331fbea29f79/2877acbf51f0/launch-d3d2ed844b44.min.js",busn_global:"https://assets.adobedtm.com/331fbea29f79/d5488db5974c/launch-35af2ea2adb5.min.js",busn_myaccount:"https://assets.adobedtm.com/331fbea29f79/f4d95eb7d4cd/launch-e25f196ed421.min.js",busn_cbm:"https://assets.adobedtm.com/331fbea29f79/376acc635afd/launch-9a4c35a64d23.min.js",busn_ecom:"https://assets.adobedtm.com/331fbea29f79/4dddf95f41c2/launch-7fa072e8cf99.min.js",busn_helpsupport:"https://assets.adobedtm.com/launch-ENa54efcba2a504c5d8937c11e2c10c559.min.js",busn_enterpriseportal:"https://assets.adobedtm.com/331fbea29f79/4069873dc6e8/launch-a2d87b136add.min.js"},d=p[o]||p[f]||p.fallback,d?(this.injectScript(d,e),!0):e("Launch URL undefined")}launchNotify(){this.notifyTimer?clearTimeout(this.notifyTimer):this.notifyStart=Date.now();let e=(Array.isArray(this.config.callbackGlobalItems)?this.config.callbackGlobalItems:[]).every(a=>n(window,a,void 0)!==void 0),r=Date.now()-this.notifyStart>this.config.notifyTimeout;if(!e&&!r){this.notifyTimer=setTimeout(this.launchNotify.bind(this),100);return}this.debugParams=["launch-initialized"],this.debug(`Dispatching Launch Loaded Event prereqMet: ${e}, timedOut: ${r}`),document.dispatchEvent(new CustomEvent("c-tracking-launch-loaded",{bubbles:!0}))}launchLoaded(){this._status="READY",this.debug("Launch Loaded Successfully"),this.processQueue(),setTimeout(this.launchNotify.bind(this),0)}processQueue(){this._initQueue.forEach(e=>{e.debugParam="from-queue",this.executeTrackingCall(e)})}injectScript(e,r){this._status="LOADING";var a=document.createElement("script");a.onerror=i=>{r(`Error loading launch, Detail: ${i.target}`)},a.onload=this.launchLoaded.bind(this),this.currentScript.parentNode.insertBefore(a,this.currentScript),a.src=e}processConfig(e){Object.keys(e).forEach(r=>{let a=e[r];switch(this.config[r]=a,r){case"spaTimeout":this.flickerIsSpa&&this.toggleFlicker(this.flickerActive,!0);break;case"initTimeout":this.flickerIsSpa||this.toggleFlicker(this.flickerActive);break;case"flickerDisable":this.flickerActive&&a===!0&&this.toggleFlicker(!1)}})}setDefaults(e){this.processConfig(n(window.digitalData,"config.plugins.launch",{})),e.detail.plugins.push({name:this._id,version:this._version,description:"Properly notify Adobe Launch tag management upon modifications to data layer",status:this._status,appId:this.currentScript&&v("appId",this.currentScript.src),workflowId:this.currentScript&&v("workflowID",this.currentScript.src)})}executeTrackingCall(e){try{if(this.debugParams=["executeTrackingCall"],e.debugParam&&this.debugParams.unshift(e.debugParam),this._status!=="READY"){this._status!=="ERROR"&&(this._initQueue.push({detail:{...e.detail}}),n(window,"_satellite.buildInfo")?this.launchLoaded():n(window,"_satellite.configurationSettings")&&this.setStatus("ERROR")('Instance of "_satellite.configurationSettings" already found!'));return}var r=l({},e.detail.data.eventInfo),a="";switch(e.detail.type){case"page":a="custom-PageLoad";break;case"custom":e.detail.data.eventInfo||(r.eventMethod="custom-PageUpdate");default:e.detail.type.startsWith("c-tracking-init-")?a="custom-"+e.detail.type.replace("c-tracking-",""):a=r.eventMethod||"send-Event";break}a==="targetStart"&&r.type==="spa"?(this.initStart=Date.now(),this.toggleFlicker(!0,!0)):a==="custom-PageLoad"&&this.config.noTargetDelay?this.toggleFlicker(!1):a==="targetUpdate"&&this.processConfig(r),window._satellite.track(a,r),this.debugParams.push(a),this.debug(`Event Info:
`+JSON.stringify(e.detail.data.eventInfo,null,2))}catch(i){this.debug("EXCEPTION:",i)}}},l_=new At;var Ot=class{constructor(){l(this,x),this._id="DTM",this._version="3.20.3",this.debugHeader=`Data Layer ${this._id} Plugin`,this.debugParams=[],this.bindListeners()}bindListeners(){document.addEventListener("c-tracking-trigger",this.executeTrackingCall.bind(this),!1),document.addEventListener("c-tracking-load-defaults",this.setDefaults.bind(this),!1)}setDefaults(e){l(e.detail,{event:[],page:{attributes:{isPageLoadVariables:!1}}}),e.detail.plugins.push({name:this._id,version:this._version,description:"Properly notify Adobe Dynamic tag management upon modifications to data layer",errorDetected:this.checkErrors()})}dtmInit(){this.checkErrors(),this.dtmError||window._satellite.pageBottom()}checkErrors(){return(this.dtmError||typeof window._satellite>"u"||typeof window._satellite.track!="function"||typeof window._satellite.pageBottom!="function"||typeof window._satellite.buildInfo<"u")&&(this.dtmError=!0),this.dtmError}executeTrackingCall(e){try{var r=l({},e.detail.data.eventInfo),a="";switch(e.detail.type){case"page":a="custom-PageLoad";break;case"c-tracking-init-end":this.dtmInit();case"custom":e.detail.data.eventInfo||(r.eventMethod="custom-PageUpdate");default:e.detail.type.startsWith("c-tracking-init-")?a="custom-"+e.detail.type.replace("c-tracking-",""):a=r.eventMethod||"send-Event";break}this.debugParams=[a],this.debug(a=="send-Event"?`
`+JSON.stringify(e.detail.data.eventInfo,null,2)+`
`:"",this.dtmError?"DTM NOT AVAILABLE!":""),this.dtmError||window._satellite.track(a)}catch(i){this.debug("EXCEPTION:",i,this.dtmError?"DTM NOT AVAILABLE!":"")}}},g_=new Ot;var Pt=class{constructor(){l(this,x),this._id="dl-plugin-js-exceptions",this._version="3.20.3",this.debugHeader=`Data Layer ${this._id} Plugin`,this.debugParams=[],this.exceptions=[],this.unhandledRejections=new Map,this.skippedCount=0,this.throttlePerError=100,this.throttleGlobalCount=0,this.throttleGlobalMax=20,this.promiseInterval=6e4,this._processError=this.processError.bind(this),this._processRejections=this.processRejections.bind(this,!0),this._rejectionHandled=this.rejectionHandled.bind(this),this._populateDataLayer=this.populateDataLayer.bind(this),this.bindListeners(),this.setupRejectionsInterval(),this.debug("initialized")}bindListeners(){window.addEventListener("error",this._processError,!1),window.addEventListener("c-tracking-log-error",this._processError,!1),window.addEventListener("unhandledrejection",this._processError,!1),window.addEventListener("rejectionhandled",this._rejectionHandled,!1),window.addEventListener("beforeunload",this._processRejections,!1),document.addEventListener("c-tracking-load-defaults",this._populateDataLayer,!1)}populateDataLayer(e){this.processConfig(n(window.digitalData,"config.plugins.exceptions",{})),n(e,"detail.plugins",[]).some(a=>a.name===this._id)?(window.removeEventListener("error",this._processError),window.removeEventListener("c-tracking-log-error",this._processError),window.removeEventListener("unhandledrejection",this._processError),window.removeEventListener("rejectionhandled",this._rejectionHandled),window.removeEventListener("beforeunload",this._processRejections),document.removeEventListener("c-tracking-load-defaults",this._populateDataLayer),clearInterval(this.interval)):e.detail.plugins.push({name:this._id,version:this._version})}setupRejectionsInterval(){clearInterval(this.interval),this.promiseInterval&&(this.interval=setInterval(()=>this.processRejections(!1),this.promiseInterval))}processConfig(e){let r=n(e,"promiseInterval",this.promiseInterval);r!==this.promiseInterval&&(this.promiseInterval=r,this.setupRejectionsInterval())}sendInfo(e){let r=new CustomEvent("c-tracking-log",{detail:{eventInfo:e},bubbles:!0});this.debug("sendInfo: ",r),document.body.dispatchEvent(r)}dataLayerUpdated(e){n(e,"detail.type","")==="page"&&this.exceptions.length&&(this.exceptions.forEach(r=>{setTimeout(this.sendInfo.bind(this,r),0)}),this.exceptions=[])}rejectionHandled(e){this.unhandledRejections.delete(this.rawPromiseMessage(e))}processError(e){if(e.reason){e.message=this.generatePromiseMessage(e),e.capturedTimeStamp=new Date;let r=this.rawPromiseMessage(e);this.unhandledRejections.has(r)||this.unhandledRejections.set(r,e)}else this.trackError(e)}processRejections(e){this.debug(`Processing Unhandled Promise Rejections: Count(${this.unhandledRejections.size})`),this.unhandledRejections.forEach(r=>{this.trackError(r,e)}),this.unhandledRejections.clear()}trackError(e,r){let a=!1,i={_sendWithBeacon:r,eventMethod:"client-exception",eventType:"js",eventName:e.type};if(e.type==="c-tracking-log-error"&&(e=e.detail),e.message||(this.debug("Skipped the tracking of an error event due to missing error message: ",e),a=!0),this.throttleGlobalCount>this.throttleGlobalMax?(this.debug("skip track - Maximum error threshold reached:",e),a=!0):e["dl-handled"]?(this.debug("skip track - error previously tracked:",e),a=!0):this.lastTracked&&(this.lastTracked.message===e.message||e.message?.match(/script\serror/i))&&this.lastTracked.ts+this.throttlePerError>Date.now()&&(this.debug("skip track - another error of this type was tracked in the last 100 ms:",e),a=!0),this.lastTracked=e,this.lastTracked.ts=Date.now(),e["dl-handled"]=!0,a){this.skippedCount++;return}this.debug("Tracking Error: ",e),i=l(i,{eventAction:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,type:n(e,"reason.name")||n(e,"error.name"),stack:n(e,"reason.stack")||n(e,"error.stack")||e.stack,skippedCount:this.skippedCount,timeStamp:e.capturedTimeStamp}),this.skippedCount=0,this.throttleGlobalCount++,window.digitalData&&document.body?this.sendInfo(i):this.exceptions.push(i)}generatePromiseMessage(e){let r=this.rawPromiseMessage(e),a=e.reason.name?`${e.reason.name}: `:"";return`${e.type}: ${a}${r}`}rawPromiseMessage(e){return e.reason.message||e.reason}},__=new Pt;var Dt=class{constructor(){l(this,x),this._id="Timeline",this.debugHeader=`Data Layer ${this._id} Plugin`,this.debugParams=[],this._version="3.20.3",this.bindListeners(),this.debug("initialized")}bindListeners(){this.checkErrors()||(document.addEventListener("c-tracking-trigger",this.executeTrackingCall.bind(this),!1),document.addEventListener("c-tracking-load-defaults",this.setDefaults.bind(this),!1))}setDefaults(e){e.detail.plugins.push({name:this._id,version:this._version,description:"Pass Data-Layer information to aws lambda timeline end point",errorDetected:this.checkErrors()})}checkErrors(){return(this.pluginError||typeof XMLHttpRequest!="function")&&(this.pluginError=!0),this.pluginError}isCustomerType(e,r){let a=n(e,"digitalData.transaction.attributes",null)||n(window,"digitalData.transaction.attributes",null);return a?.buyflowType==="All digital buyflow|dotcom"&&a?.buyflowStep==="order"&&a?.flowType===r}generateTimelineRequest(e){this.debug("INFO: ",e,"GENERATE TIMELINE REQUEST");let r=n(e,"digitalData.page.pageInfo.pageName","")||n(window,"digitalData.page.pageInfo.pageName",""),a=n(e,"digitalData.user[0].profile[0].profileInfo.custGUID",null)||n(window,"digitalData.user[0].profile[0].profileInfo.custGUID",null);if(!a)return this.debug("NO CUST GUID"),null;let i={interactionType:"SALES_RETENTION",channel:"MY_ACCOUNT_WEB",custGUID:a};switch(r){case"resi|sales|shop||home":return{...i,actionId:"LEARN_OVERVIEW"};case"resi|sales|shop|myplan|gbboffers2.0":return{...i,actionId:"SALES_CENTER"};case"resi|sales|shop|movers|localization":return{...i,actionId:"MOVES"};case"resi|sales|shop|learn|offers":return{...i,actionId:"ALL_OFFERS"};case"resi|sales|shop|learn|Plan Builder":return{...i,actionId:"PLANBUILDER"};default:return this.isCustomerType(e,"NewCustomer")?{...i,actionId:"NEW_CUSTOMER_ORDER"}:(this.debug("INFO:",r,"PAGE NAME NOT FOUND"),null)}}sendRequest(e){var r=new XMLHttpRequest;r._fromDL=!0,r.onreadystatechange=r.ontimeout=function(a){a.target.readyState===XMLHttpRequest.DONE&&(this.debugParams=["Timeline Update","done"],this.debug(r.status===200?"SUCCESS":"FAILED",', Type: "',a.type,'", Request Obj: ',a.target))}.bind(this),this.debug("INFO: ","https://4ob33768rg.execute-api.us-east-1.amazonaws.com/prod/five-standards","OPENING REQUEST TO SEND"),r.open("POST","https://4ob33768rg.execute-api.us-east-1.amazonaws.com/prod/five-standards"),r.setRequestHeader("Content-Type","application/json"),r.send(JSON.stringify(e))}dlUpdateTimeline(e){let r=this.generateTimelineRequest(e);r&&this.sendRequest(r)}executeTrackingCall(e){try{let r=l({},e.detail.data);n(e,"detail.type","")==="page"&&this.dlUpdateTimeline(r)}catch(r){this.debug("EXCEPTION:",r,this.pluginError?"TIMELINE AWS LAMBDA NOT AVAILABLE!":"")}}},I_=new Dt;function gu(t,e={}){let r=e,a=[];function i(){return r}function s(o){r=t(r,o),a.forEach(d=>d())}function f(o){a.push(o)}return{dispatch:s,subscribe:f,getState:i}}function pi(t){let e=Object.values(t);for(let r=0;r<e.length;r++)if(e[r]?.pendingCount>0)return!0;return!1}function bu(t,e){switch(e.type){case"pending":return t.pendingProcesses[e.process]={pendingCount:t.pendingProcesses?.[e.process]?.pendingCount+1||1},{...t,type:e.type,lastestEvent:e.event,isPending:pi(t.pendingProcesses)};case"complete":return t.pendingProcesses[e.process]={pendingCount:t.pendingProcesses?.[e.process]?.pendingCount>1?t.pendingProcesses?.[e.process]?.pendingCount-1:0},{...t,type:e.type,lastestEvent:e.event,isPending:pi(t.pendingProcesses)};default:return t}}function li(t){let e={isPending:!1,pendingProcesses:{}},{subscribe:r,getState:a,dispatch:i}=gu(bu,e);return r(()=>{let{type:s,isPending:f,lastestEvent:o,pendingProcesses:d}=a();t({type:s,isPending:f,ev:o,pendingProcesses:d})}),document.addEventListener("c-tracking-process-pending",s=>{i({type:"pending",event:s,process:s.detail?.process||"DL_CATCHALL_PROCESS"})},!1),document.addEventListener("c-tracking-process-complete",s=>{i({type:"complete",event:s,process:s.detail?.process||"DL_CATCHALL_PROCESS"})},!1),a().isPending}function ci(){typeof Element.prototype.attachShadow=="function"&&!Element.prototype._DLattachShadow&&(Element.prototype._DLattachShadow=Element.prototype.attachShadow,Element.prototype.attachShadow=function(t={}){return t.mode="open",this._DLattachShadow(t)},Element.prototype.attachShadow.toString=function(){return Element.prototype._DLattachShadow.toString()})}function mi(t){xu(t),_u(t),yu(t)}function yu(t){if(window.fetch){let e=window.fetch;window.fetch=function(r,a){a=a||{};let i=e(r,a);try{let s=n(r,"body",n(a,"body",null));i._perfDebug={requestBody:s},t.trackAjax(i._perf={eventMethod:"c-tracking-ajax",url:!r||typeof r=="string"?r:r.url||r.toString(),source:"fetch",method:a.method||"GET",requestStart:Date.now()})}catch{}return i.then(s=>{try{s.clone().text().then(function(f){i._perfDebug.responseBody=f}).catch(function(){}).finally(function(){t.requestCallback.bind(i)(t,s)})}catch{}return i}).catch(s=>{try{s.name==="AbortError"&&(i._perf.status=499),t.requestCallback.bind(i)(t,s)}catch{}return i})}}}function xu(t){if(n(window,"Navigator.prototype.sendBeacon")){let e=window.Navigator.prototype.sendBeacon;Navigator.prototype.sendBeacon=function(r){let a=e.apply(this,arguments),i={eventMethod:"c-tracking-ajax",url:r,source:"beacon",method:"POST",success:a,requestStart:Date.now()};return t.trackAjax(i),a}}}function _u(t){var e=XMLHttpRequest.prototype;e._open=e.open,e.open=function(r,a){t.trackAjax(this._perf={eventMethod:"c-tracking-ajax",url:a,method:r,source:"xhr"}),e._open.apply(this,arguments)},e._send=e.send,e.send=function(r){this._perf||t.trackAjax(this._perf={eventMethod:"c-tracking-ajax",method:"UNKNOWN",source:"xhr"}),this._perf.requestStart=Date.now();let a=function(i){try{n(this,"response")&&!this.fromDL&&(this._perfDebug.responseBody=this.response)}catch{}t.requestCallback.call(this,t,i)};this.addEventListener("load",a),this.addEventListener("error",a),this.addEventListener("abort",a),this.addEventListener("timeout",a),this._perfDebug={},r&&!this.fromDL&&(this._perfDebug.requestBody=r),e._send.apply(this,[r])}}function wu(){try{return window.opr&&opr.addons||window.opera||navigator.userAgent.indexOf(" OPR/")>=0?"Opera":typeof InstallTrigger<"u"?"Firefox":/constructor/i.test(window.HTMLElement)||function(t){return t.toString()==="[object SafariRemoteNotification]"}(!window.safari||typeof safari<"u"&&safari.pushNotification)?"Safari":window.StyleMedia?"Edge":window.chrome&&(window.chrome.webstore||window.chrome.runtime)?"Chrome":"Unknown"}catch{return"Error"}}function nt(t,e){try{return e.reduce((r,a)=>(r[a]=t?window[t][a]:window[a],r),{})}catch(r){return{error:r}}}function vu(){return nt("navigator",["cookieEnabled","language","userAgent","hardwareConcurrency","maxTouchPoints"])}function Eu(){let t=nt("screen",["availTop","availLeft","availHeight","availWidth","height","width","top","left","pixelDepth","colorDepth"]);return window.screen.orientation&&(t.orientation={type:window.screen.orientation.type,angle:window.screen.orientation.angle}),t}function Iu(){return nt(null,["innerWidth","innerHeight","outerWidth","outerHeight","devicePixelRatio"])}function Tt(){return nt("location",["href","protocol","host","hostname","port","pathname","search","hash","origin"])}function hi(){return{navigator:vu(),screen:Eu(),window:Iu(),location:Tt(),referrer:document.referrer,referrerLocation:U(document.referrer),browserName:wu()}}var kt=class{constructor(){let e=P();this.appId=e&&v("appId",e.src),l(this,x),this.debugHeader="Data Layer Core",this.debugParams=[],this.defineVars(),ci(),mi(this),this.bindListeners()}defineVars(){it(this,{_id:"Data Layer",_version:"3.20.3",_objectPrefix:"tracking-data-",_keyPrefix:"data-tracking-",_isProcessPending:!1,_pageViewCount:0,_eventQueue:[],_pageUnloading:null,_pageViewStart:n(window,"performance.timing",{}).requestStart||Date.now(),_triggerPage:!1,_triggerPageDetail:null,_mergeArrays:null,_performance:null,_ajaxPerfQ:[],_triggerQueue:[],_waiting:0,_selectors:{actionable:"a, button",sharedData:'script[type="tracking-data"]',parentBlock:"[data-tracking-parent], body",trackingInfo:"[data-tracking]",eventContainer:"[data-tracking-event-container]",eventSuppress:"[data-tracking-auto-event-suppress]",checkedSelector:'input[type="checkbox"], input[type="radio"]',checkedAttributeChecked:"data-tracking-checked",checkedAttributeUnChecked:"data-tracking-unchecked",media:"video, audio"},_initQueue:[],_operational:!1,_ajaxExclude:["https://dl.cws.xfinity.com/event/".toLowerCase(),"NONE".toLowerCase(),"https://dss-dl-prod.aws-origin.xfinity.com/prod/event/".toLowerCase(),"https://4ob33768rg.execute-api.us-east-1.amazonaws.com/prod/five-standards".toLowerCase(),"col.eum-appdynamics.com","comcast-app.quantummetric.com","omtrdc.net","metrics.comcast.com","metrics.xfinity.com"]},(e,r)=>{if(Array.isArray(r))return r}),this.fullDataType=this._objectPrefix+"digitalData",l(this._selectors,{defaultEl:`${this._selectors.checkedSelector},${this._selectors.actionable},${this._selectors.media}`,clickElements:`a, button,${this._selectors.checkedSelector}`,objectData:'script[type^="{0}"]'.replace(/\{0}/g,this._objectPrefix)}),this["init-start-exec"]=this["init-end-exec"]=this["init-complete-exec"]=null}mergeOptions(e,r){if(typeof e<"u"&&(this._mergeArrays||(r||e).arrayAppend||!Array.isArray(e))&&Array.isArray(r))return r=r.concat(e),r}endTimeOnPage(e){if(this._pageUnloading)return;e?this._pageUnloading=!0:e={eventPhase:"inline",type:"spa"};let r=n(window,"digitalData.performance.pageView",{});r.unload=Date.now(),r.end&&(r.timeOnPage=r.unload-r.end),w(window,"digitalData.performance.pageView",r),this.trigger({data:{eventInfo:{_sendWithBeacon:!0,eventMethod:"c-tracking-log-page-unload",eventType:e.type.toLowerCase(),eventPhase:e.eventPhase,performance:{pageView:n(window,"digitalData.performance.pageView",{})}}},trigger:document.body,type:"unload"}),n(window,"digitalData")&&delete window.digitalData.performance}manageInitLifeCycle(){let e=s=>{this[`init-${s}-exec`]||(this.debugParams=[`init-${s}-exec`],this[`init-${s}-exec`]=!0,this.trackInit({type:`c-tracking-init-${s}`,target:document}),this.debugParams=[])},r=()=>{e("start")},a=()=>{r(),e("end")},i=()=>{r(),a(),e("complete"),this._operational=!0,this._triggerPage&&this.pageTrack({type:"init-complete"}),this.processInitQueue()};switch(document.readyState){case"complete":i();break;case"interactive":a();break;case"loading":r();break}}bindTimingListeners(){this._isProcessPending=li(({type:e,isPending:r,ev:a,pendingProcesses:i})=>{this.debugParams=[`process-${e}`],this._isProcessPending=r,this.debug(JSON.stringify({isPending:r,pendingProcesses:i},null,2)),!this._isProcessPending&&this._triggerPage&&this.pageTrack(a)}),document.addEventListener("c-tracking-wait",()=>{this._waiting++},!1),document.addEventListener("c-tracking-resume",e=>{this.debugParams=[e.type.toLowerCase()],this._waiting>0&&this._waiting--,this._waiting===0&&(this._triggerQueue.forEach(r=>{r.element!=document&&(!r.element.closest||!N(r.element,"body"))&&(r.element=document.body),this.triggerEvent(r.element,r.name,r.data)}),this._triggerQueue=[])})}bindListeners(){this.manageInitLifeCycle(),document.addEventListener("readystatechange",this.manageInitLifeCycle.bind(this),!0),window.addEventListener("beforeunload",this.endTimeOnPage.bind(this),!0),window.addEventListener("unload",this.endTimeOnPage.bind(this),!0),document.addEventListener("c-tracking-log",this.customTrack.bind(this),!1),document.addEventListener("c-tracking-log-dom",this.domTrack.bind(this,"dom"),!1),this.bindTimingListeners(),document.addEventListener("c-tracking-log-page",this.pageTrack.bind(this),!1),document.addEventListener("c-tracking-log-update",this.pageUpdate.bind(this),!1),document.addEventListener("c-tracking-log-page-start",()=>{n(window,"digitalData.performance")&&(this.endTimeOnPage(),this._pageViewStart=this._pageViewStart||Date.now(),this.trigger({data:{eventInfo:{eventMethod:"targetStart",type:"spa"}},trigger:document.body,type:"targetStart"}))},!1),this.bindClickEvents(),this.bindMediaEvents()}triggerQueuedEvents(){this._eventQueue.forEach(e=>{switch(e.type){case"dom":this.domTrack(e.subtype,e.ev,e.data);break;default:this.trigger(e.payload);break}})}getEventElement(e){let r;return typeof e.composedPath=="function"&&e.composedPath()?.length?r=e.composedPath()[0]:window.Polymer&&typeof window.Polymer.dom=="function"?r=typeof window.Polymer.dom(e).rootTarget:r=e.target?e.target.correspondingUseElement||e.target:null,r}triageEvent(e){e.hasOwnProperty("s_fe")&&(e._dlHandled=!0,this.debugParams.push("Skipped"),this.debug("Duplicate Adobe Event Skipped",e))}bindClickEvents(){let e=a=>{if(this.debugParams=[a.type.toLowerCase()],this.triageEvent(a),a._dlHandled){a._dlTracked&&(this.debugParams.push("Skipped"),this.debug("Click Handler Skipped",a));return}a._dlHandled=!0;let i=this.getEventElement(a);i=i&&N(i,this._selectors.clickElements),i&&!N(i,this._selectors.eventSuppress)&&(a._dlTracked=!0,this.domTrack("click",a))};document.addEventListener("click",e,!1),document.addEventListener("click",e,!0);let r=()=>{document.removeEventListener("c-tracking-init-end",r,!1),document.body&&(document.removeEventListener("click",e,!1),document.body.addEventListener("click",e,!1),document.removeEventListener("click",e,!0),document.body.addEventListener("click",e,!0))};document.addEventListener("c-tracking-init-end",r,!1),document.addEventListener("c-tracking-unbind-click",a=>{a.target.removeEventListener("click",e,!1),a.target.removeEventListener("click",e,!0)},!1),document.addEventListener("c-tracking-bind-click",a=>{a.target.removeEventListener("click",e,!1),a.target.addEventListener("click",e,!1),a.target.removeEventListener("click",e,!0),a.target.addEventListener("click",e,!0)},!1)}bindMediaEvents(){document.addEventListener("playing",this.trackMediaState.bind(this),!0),document.addEventListener("ended",this.trackMediaState.bind(this),!0),document.addEventListener("pause",this.trackMediaState.bind(this),!0)}triggerEvent(e,r,a){if(this._waiting>0&&["c-tracking-load-defaults"].indexOf(r)===-1){this._triggerQueue.push({element:e,name:r,data:a});return}let i=new CustomEvent(r,{detail:a,composed:!0,bubbles:!0});e.dispatchEvent(i)}trackMediaState(e){this.debugParams=[e.type.toLowerCase()];let r=this.getEventElement(e),a={eventAction:e.type},i=!0;if(r.matches(this._selectors.media)&&!N(r,this._selectors.eventSuppress)){switch(a.timePlayed=r.currentTime,a.duration=r.duration,a.type=r.tagName.toLowerCase(),a.loop=r.hasAttribute("loop")&&r.getAttribute("loop")!=="false",a.autoplay=r.hasAttribute("autoplay"),a.controls=r.getAttribute("controls"),a.controls||delete a.controls,a.poster=r.getAttribute("poster"),a.poster||delete a.poster,a.muted=r.getAttribute("muted"),a.muted||delete a.muted,a.loop&&r.hasAttribute("c-t-"+e.type)&&(i=!1),e.type){case"playing":r.getAttribute("isPaused")==="true"&&(a.resume=r.hasAttribute("isPaused"),r.removeAttribute("isPaused"));break;case"pause":a.timePlayed!==a.duration?r.setAttribute("isPaused","true"):i=!1;break}i&&(this.triggerEvent(r,"c-tracking-log-dom",a),r.setAttribute("c-t-"+e.type,!0))}}elementsToJSON(e,r){let a=this.collectJSONfromElements(e,r),i={eventInfo:{},digitalData:{}};return a.unshift(i),a.push(this.mergeOptions.bind(this)),i=it.apply(this,a),i}collectJSONfromElements(e,r){return Array.prototype.slice.call(e).map(a=>{let i=a.matches("script")?a.innerHTML:a.getAttribute("data-tracking"),s=a.getAttribute("type"),f,o={eventInfo:{},digitalData:{}},d=!0;try{f=JSON.parse(i)}catch{d=!1}if(d&&typeof f!="object"&&(d=!1,f=null),!d&&i.trim()!==""&&this.debug(`Warning - Invalid JSON found: 
`,i,`
Element:
`,a),a.matches(this._selectors.objectData)){let u={};if(s===this.fullDataType)u=l({},u,f);else{let c=s.replace(new RegExp(`^${this._objectPrefix}`),"");u[c]=f,a.matches("script")&&a.hasAttribute("data-tracking-append")&&(u[c].arrayAppend=!0)}o[r==="dom"?"eventInfo":"digitalData"]=u}else f&&(o.eventInfo=f);let p=a.attributes;if(p){let u=p.length,c,m;for(;u--;)if(p[u]&&({name:c}=p[u],c.startsWith(this._keyPrefix)&&!bt([this._selectors.checkedAttributeChecked,this._selectors.checkedAttributeUnChecked],c))){m=a.getAttribute(c);try{o.digitalData[c.replace(new RegExp(`^${this._keyPrefix}`),"")]=JSON.parse(m)}catch{m.trim()!==""&&this.debug(`Warning - Invalid JSON found: 
`,m,`
Element:
`,a,`
Attribute:
`,c)}}}return o.digitalData.event&&o.digitalData.event.length&&(o.eventInfo=l({},o.digitalData.event[0],o.eventInfo),delete o.digitalData.event),o})}getEventParent(e,r,a){let i;return e.composedPath&&typeof e.composedPath=="function"&&e.composedPath().length?i=e.composedPath().find(f=>f!==r&&f.matches&&f.matches(a)):i=N(r,a),i||r&&N(r,a)}domTrack(e,r){this.debugParams=[r.type.toLowerCase()];let a=n(r,"detail.eventMethod","");if(this._isProcessPending&&!a.startsWith("tracking-dispatch-")){this._eventQueue.push({type:"dom",subtype:e,ev:{target:this.getEventElement(r),detail:r.detail,type:r.type}});return}let i=this.getEventElement(r),s=this.getEventParent(r,i,this._selectors.parentBlock),f=i.matches(this._selectors.eventContainer)?i:this.getEventParent(r,i,this._selectors.eventContainer),o=[],d;var p=r.detail;if(Array.prototype.push.apply(o,Array.prototype.filter.call(s.children,h=>h.matches(this._selectors.sharedData))),Array.prototype.push.apply(o,(f||i).querySelectorAll(this._selectors.sharedData)),typeof r.composedPath=="function"?Array.prototype.push.apply(o,r.composedPath().filter(h=>i!==h&&h.matches&&h.matches(this._selectors.trackingInfo)).reverse()):(s.matches(this._selectors.trackingInfo)&&o.push(s),Array.prototype.push.apply(o,dt(i,s).filter(h=>h.matches&&h.matches(this._selectors.trackingInfo)).reverse())),i.matches(this._selectors.trackingInfo)){o.push(i);let h=i.getAttribute("data-tracking");try{h=JSON.parse(h)}catch{h.trim()!==""&&this.debug(`Warning - Invalid JSON found: 
`,h,`
Element:
`,i)}}let u=f||N(i,this._selectors.defaultEl),c,m;if(u&&(c=u.querySelectorAll(this._selectors.objectData),m=this.elementsToJSON(c,"dom")),this._mergeArrays=!0,d=this.elementsToJSON(o,"dom"),u&&c.length&&(d=l({},m,d)),p&&(p.event?(l(d.eventInfo,p.event[0]),delete p.event,l(d.digitalData,p)):l(d.eventInfo,p)),i.matches(this._selectors.checkedSelector)){let h=i.matches(":checked")?i.getAttribute(this._selectors.checkedAttributeChecked):i.getAttribute(this._selectors.checkedAttributeUnChecked);try{h=JSON.parse(h),l(d.eventInfo,h)}catch{h.trim()!==""&&this.debug(`Warning - Invalid JSON found: 
`,h,`
Element:
`,i,`
Is Checked:
`,i.matches(":checked"))}}this.setDefaultEventValues(d,r,i),this._mergeArrays=!1,this.debugParams.push(n(d,"eventInfo.eventMethod")),this.trigger({data:d,trigger:i,type:e})}setDefaultEventValues(e,r,a){let i=N(a,this._selectors.defaultEl)||a,s=(i.tagName||i.nodeName||"").toLowerCase();if(typeof e.eventInfo.type>"u"&&(e.eventInfo.type=r.type),typeof e.eventInfo.eventName>"u"&&(e.eventInfo.eventName=s+(i.type?"[type='"+i.type.toLowerCase()+"'] ":" ")+r.type),typeof e.eventInfo.eventAction>"u"){let f=null;i.matches(this._selectors.checkedSelector)?(f=`Name:${i.getAttribute("name")}, Value:${i.value}`,f+=i.matches(":checked")?", :checked":", :unchecked"):i.matches(this._selectors.media)?f=r.type:i.matches(this._selectors.actionable)&&(f=this.getActionElementDefault(i)),f!==null&&(e.eventInfo.eventAction=f)}i.matches(this._selectors.media)&&typeof e.eventInfo[`${s}Name`]>"u"&&(e.eventInfo[`${s}Name`]=(i.src||i.currentSrc||(i.querySelector("source")||{}).src||"UNKNOWN").toLowerCase()),(typeof e.eventInfo.eventPage>"u"||e.eventInfo.eventPage==="")&&(n(e,"eventInfo.screenName")&&n(window,"digitalData.schemaVersion")?e.eventInfo.eventPage=this.buildPageName(n(e,"eventInfo.screenName")):e.eventInfo.eventPage=n(window,"digitalData.page.pageInfo.pageName")),typeof e.eventInfo.eventMethod>"u"&&i.matches(this._selectors.media)&&(e.eventInfo.eventMethod=`${s}-Track`),typeof e.eventInfo.eventPhase>"u"&&(e.eventInfo.eventPhase=r.eventPhase)}getActionElementDefault(e){let r="";return r=r||e.getAttribute("aria-label"),r=r||e.getAttribute("title"),r=r||e.innerText,!r&&e.querySelector("img")?.hasAttribute("alt")&&(r=e.querySelector("img").getAttribute("alt")),!r&&e.querySelector("svg")?.hasAttribute("aria-label")&&(r=e.querySelector("svg").getAttribute("aria-label")),r.trim()}trackInit(e){let r=e&&e.target?e.target.querySelectorAll(this._selectors.objectData):document.querySelectorAll(this._selectors.objectData),a=this.elementsToJSON(r,"page");w(a.digitalData,"browserInfo.location",Tt()),this.trigger({data:a,trigger:e&&e.target,type:e.type.toLowerCase()}),e.type.toLowerCase()==="c-tracking-init-start"&&(this.debugParams.push("targetStart"),this.trigger({data:{eventInfo:{eventMethod:"targetStart",type:"init"}},trigger:document.body,type:"targetStart"}))}pageUpdate(e){this.debugParams=[e.type.toLowerCase(),"page-update"];var r=e&&e.target?e.target.querySelectorAll(this._selectors.objectData):document.querySelectorAll(this._selectors.objectData),a=e.detail||{},i=this.elementsToJSON(r,"page");if(l(i,{digitalData:a}),this._isProcessPending||!this._operational){this._triggerPageDetail=l(this._triggerPageDetail,a);return}this.trigger({data:i,trigger:e&&e.target,type:"update"})}pageTrack(e){if(this.debugParams=[e.type.toLowerCase(),"page-track"],this._isProcessPending||!this._operational){this._triggerPageDetail=l(this._triggerPageDetail,e.detail),this._triggerPage=!0;return}this._triggerPage=!1;let r=e&&e.target?e.target.querySelectorAll(this._selectors.objectData):document.querySelectorAll(this._selectors.objectData),a=e.detail||{},i=this.elementsToJSON(r,"page");a=l(this._triggerPageDetail,a),this._triggerPageDetail=null,l(i,{digitalData:a}),this.trigger({data:i,trigger:e&&e.target,type:"page"}),this.triggerQueuedEvents()}customTrack(e){this.debugParams=[e.type.toLowerCase(),"custom-track"],this.trigger({data:e.detail,trigger:e.target,type:"custom"})}processInitQueue(){this._initQueue.forEach(e=>{this.debugParams=[`init-queue [${e.type}]`],this.trigger(e),this.debugParams=[]}),this._initQueue=[]}trigger(e){let r=n(e,"type",""),a=n(e,"data.eventInfo.eventMethod","");if(!this._operational&&!(r.startsWith("c-tracking-init-")||r==="targetStart")&&!a.startsWith("tracking-dispatch-")){this._initQueue.push(e);return}else if(this._isProcessPending&&e.data&&this._triggerPage&&!(r.startsWith("c-tracking-init-")||r==="targetStart")&&!a.startsWith("tracking-dispatch-")){this._eventQueue.push({type:"trigger",payload:e});return}e.trigger=e.trigger||document,e.data=e.data||{},this.setDataLayer(e.trigger,e),this.debug(`
digitalData Object: `,window.digitalData,`
digitalData Value:
`,JSON.stringify(window.digitalData,null,2)),e.type!=="update"&&this.triggerEvent(e.trigger,"c-tracking-trigger",e)}requestCallback(e,r){this._perf&&(this._perf.url||(this._perf.url=this.responseURL||""),this._perf.requestEnd=Date.now(),typeof this._perf.requestStart=="number"&&(this._perf.requestMS=this._perf.requestEnd-this._perf.requestStart),r.stack&&(this._perf.stack=r.stack),r.message&&(this._perf.eventAction=r.message),this._perf.type=r.type,this._perf.status=this.status||r.status||this._perf.status,this._perf.status>=200&&this._perf.status<=299&&delete this._perfDebug,this._fromDL||e.recordAjax(this._perf,this._perfDebug))}shouldTrack(e){return!this._ajaxExclude.some(r=>e.toLowerCase().indexOf(r)!==-1)}recordAjax(e,r){if(Le(this.appId)||Ce(this.appId)||Nt(this.appId))if(this.shouldTrack(e.url)){delete e.url,delete e.eventMethod;let a={eventInfo:{eventMethod:"c-tracking-ajax",eventType:e.source,type:"complete",skipEventKeys:["user[0].segment","browserInfo.location"],performance:{ajax:[{...r,...e}]}}};this.setDefaultEventValues(a,{},document.body),w(a.eventInfo,"browserInfo.location",U(location.href)),delete a.eventInfo.eventName,this.trigger({data:a,trigger:document.body,type:"ajax"})}else this.debug("Ajax recording skipped",e)}trackAjax(e){this.shouldTrack(e.url)&&(e.location=U(e.url),n(window,"digitalData.performance.ajax")?window.digitalData.performance.ajax.push(e):(this._ajaxPerfQ=this._ajaxPerfQ||[],this._ajaxPerfQ.push(e)))}customAssign(e,r){return Array.isArray(r)?re(r.map(a=>ve(a)?re(he({},a,this.customAssign.bind(this)),te):typeof a=="number"&&a!==0||typeof a=="string"?a:null),te):ve(r)?re(he({},r,this.customAssign.bind(this)),te):typeof r=="number"&&r!==0||typeof r=="string"?r:null}pagePerf(e){window.performance?e.performance=this._performance||(this._performance={timing:re(he({},window.performance.timing,this.customAssign.bind(this)),te),navigation:re(he({},window.performance.navigation,this.customAssign.bind(this)),te)}):e.performance=e.performance||{missingPerformanceObject:!0},e.performance.ajax=this._ajaxPerfQ||[],delete this._ajaxPerfQ;let r=this._pageViewStart,a=Date.now();e.performance.pageView={start:r,end:a,count:this._pageViewCount},this._pageViewCount>0&&!this._pageViewStart?(e.performance.pageView.start=null,e.performance.pageView.invalidStartTime=!0):e.performance.pageView.ms=a-r,delete this._pageViewStart}setDataLayer(e,r){let{data:a}=r,i={version:this._version,plugins:[]};this.triggerEvent(e,"c-tracking-load-defaults",i),(r.type||"").startsWith("c-tracking-init-")?(i.timeStamp=i.timeStamp||new Date,window.digitalData=i):r.type==="page"?(this.pagePerf(i),i.browserInfo=hi(),n(a,"digitalData.page.pageInfo.screenName")||w(a,"digitalData.page.pageInfo.screenName",window.location.pathname),i.timeStamp=i.timeStamp||new Date,window.digitalData=i,this._pageViewCount++):window.digitalData=window.digitalData||i,l(window.digitalData,a.digitalData),window.digitalData.event=window.digitalData.event||[],_t(a.eventInfo)&&r.type!=="ajax"&&(a.eventInfo.timeStamp=a.eventInfo.timeStamp||new Date,window.digitalData.event.push({eventInfo:a.eventInfo})),window.digitalData.schemaVersion&&w(window.digitalData,"page.pageInfo.pageName",this.buildPageName())}buildPageName(e){let r=[],a=window.digitalData;r.push(n(a,"page.category.businessType")),r.push(n(a,"page.category.siteType")),r.push(n(a,"page.category.primaryCategory"));let i=[...n(a,"page.category.subCategories",[])];return i.unshift(n(a,"page.category.subCategory5")),i.unshift(n(a,"page.category.subCategory4")),i.unshift(n(a,"page.category.subCategory3")),i.unshift(n(a,"page.category.subCategory2")),i.unshift(n(a,"page.category.subCategory1")),r.push(i.filter(s=>typeof s=="string"&&s.length>0).join("~")),r.push(e||n(a,"page.pageInfo.screenName")),r.join("|")}},R_=new kt;})();
/*! For license information please see datalayer-resi.min.js.LEGAL.txt */
